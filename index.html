<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://wanglu92.github.io/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://wanglu92.github.io/"/>





  <title>Hexo</title>
  








<meta name="generator" content="Hexo 5.3.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wanglu92.github.io/2021/01/18/spring%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/18/spring%E4%BD%BF%E7%94%A8/" itemprop="url">spring使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-18T14:40:12+08:00">
                2021-01-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h2><h3 id="Spring设计理念"><a href="#Spring设计理念" class="headerlink" title="Spring设计理念"></a>Spring设计理念</h3><p>当您了解框架时，不仅要了解框架的工作而且要遵循的原则很重要。以下是Spring框架的指导原则：</p>
<ul>
<li>提供各个级别的选择。Spring使您可以尽可能延迟设计决策。例如，您可以在不更改代码的情况下通过配置切换持久性框架。对于许多其他基础架构问题以及与第三方API的集成也是如此。</li>
<li>适应不同的观点。Spring拥有灵活性，并且对如何完成事情没有意见。它从不同的角度支持广泛的应用程序需求。</li>
<li>保持强大的向后兼容性。对Spring的发展进行了精心管理，以使各个版本之间几乎没有重大更改。Spring支持精心选择的JDK版本和第三方库，以方便维护依赖于Spring的应用程序和库。</li>
<li>关心API设计。Spring团队投入了大量的思想和时间来制作直观，并在许多版本和很多年中都适用的API。</li>
<li>为代码质量设置高标准。Spring框架非常强调有意义、最新和准确的javadoc。它是极少数可以声明干净代码结构且程序包之间没有循环依赖关系的项目之一。</li>
</ul>
<h2 id="spring优点"><a href="#spring优点" class="headerlink" title="spring优点"></a>spring优点</h2><ul>
<li>开源免费框架（容器）</li>
<li>轻量级非侵入式框架</li>
<li>控制反转（IOC），面向切面编程（AOP）</li>
<li>支持事务处理</li>
<li>对框架整合的支持</li>
</ul>
<p><strong><em>Spring是一个轻量级的控制反转IOC和面向切面编程AOP框架</em></strong></p>
<h3 id="Spring组成"><a href="#Spring组成" class="headerlink" title="Spring组成"></a>Spring组成</h3><p>Spring七大模块</p>
<ul>
<li>Spring Core</li>
<li>Spring AOP</li>
<li>Spring ORM</li>
<li>Spring DAO</li>
<li>Spring Web</li>
<li>Spring Context</li>
<li>Spring Web MVC</li>
</ul>
<h3 id="了解"><a href="#了解" class="headerlink" title="了解"></a>了解</h3><ul>
<li>Spring Farmwork</li>
<li>Spring Boot<ul>
<li>一个快速开发的脚手架</li>
<li>基于SpringBoot可以快速开发单个微服务</li>
<li>约定大于配置（类似maven的思想）</li>
</ul>
</li>
<li>Spring Cloud<ul>
<li>SpringCloud是基于SpringBoot实现的</li>
</ul>
</li>
</ul>
<p>现在大多数公司都在使用SpringBoot进行快速开发，学习SpringBoot的前提是需要完全撞我Spring及SpringMVC</p>
<p>弊端：发展太久，违背了原有的理念！配置十分繁琐。</p>
<h2 id="控制反转IOC"><a href="#控制反转IOC" class="headerlink" title="控制反转IOC"></a>控制反转<code>IOC</code></h2><ul>
<li>之前程序是主动创建对象，控制权在程序手中。</li>
<li>使用set注入后，程序不在具有主动性，而是变成了被动接受的对象。</li>
</ul>
<p>控制反转IOC<code>Inversion of Control</code>是一种设计思想，DI依赖注入是实现IoC的一种方法，也有人认为DI是IoC的另一种说法。没有IoC的程序中，我们使用面向对象编程，对象的创建于对象间的依赖关系完全硬编码在程序中，对象的创建由程序自己控制，控制反转后将对象的创建转移给第三方，个人认为所谓控制反转：获得依赖对象的方式反转了。</p>
<p><strong>控制反转是一种通过描述（XML或注解）并通过第三方去生产或获取特定对象的方式。在Spring中实现控制反转的是IoC容器，其实现方法是依赖注入（Dependency Injection，DI）</strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wanglu92.github.io/2021/01/17/MyBatis%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/17/MyBatis%E4%BD%BF%E7%94%A8/" itemprop="url">MyBatis使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-17T09:24:58+08:00">
                2021-01-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="MyBatis做了什么"><a href="#MyBatis做了什么" class="headerlink" title="MyBatis做了什么"></a>MyBatis做了什么</h2><ul>
<li>简化了模板代码的书写</li>
<li>简化了数据库中数据映射为bean的过程ORM框架</li>
</ul>
<p>使用JDBC需要步骤</p>
<ul>
<li>加载驱动</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(&quot;com.mysql.jdbc.Driver&quot;)</span><br></pre></td></tr></table></figure>
<ul>
<li>向java.sql.DriverManager请求并获取Connection</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection con = DriverManager.getConnection(url , username , password );</span><br></pre></td></tr></table></figure>
<ul>
<li>通过Connection获取PreparedStatement或Statement</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Statement stmt = con.createStatement();</span><br><span class="line">PreparedStatement pstmt = con.prepareStatement(sql);</span><br></pre></td></tr></table></figure>
<ul>
<li>执行sql</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ResultSet rs = stmt.executeQuery(<span class="string">&quot;SELECT * FROM ...&quot;</span>);   </span><br><span class="line"><span class="keyword">int</span> rows = stmt.executeUpdate(<span class="string">&quot;INSERT INTO ...&quot;</span>);    </span><br><span class="line"><span class="keyword">boolean</span> flag = stmt.execute(String sql);</span><br></pre></td></tr></table></figure>
<ul>
<li>遍历结果</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(rs.next())&#123;    </span><br><span class="line">  String name = rs.getString(<span class="string">&quot;name&quot;</span>) ;    </span><br><span class="line">  String pass = rs.getString(<span class="number">1</span>) ; <span class="comment">// 此方法比较高效    </span></span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure>
<ul>
<li>关闭资源</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(rs !=<span class="keyword">null</span>)&#123;   <span class="comment">// 关闭记录集    </span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    rs.close();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;    </span><br><span class="line"><span class="keyword">if</span>(stmt !=<span class="keyword">null</span>)&#123;   <span class="comment">// 关闭声明    </span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    stmt.close();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(conn !=<span class="keyword">null</span>)&#123;  <span class="comment">// 关闭连接对象    </span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    conn.close();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用MyBatis的步骤</p>
<ul>
<li>构建 SqlSessionFactory</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String resource = <span class="string">&quot;org/mybatis/example/mybatis-config.xml&quot;</span>;</span><br><span class="line">InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br></pre></td></tr></table></figure>
<ul>
<li>SqlSessionFactory 中获取 SqlSession</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SqlSession session = sqlSessionFactory.openSession()</span><br></pre></td></tr></table></figure>
<ul>
<li>使用SqlSession执行sql</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BlogMapper mapper = session.getMapper(BlogMapper.class);</span><br><span class="line">Blog blog = mapper.selectBlog(<span class="number">101</span>);</span><br></pre></td></tr></table></figure>
<h2 id="MyBatis详细执行流程"><a href="#MyBatis详细执行流程" class="headerlink" title="MyBatis详细执行流程"></a>MyBatis详细执行流程</h2><p><code>Resources</code>对象获取加载配置文件</p>
<p><code>Configuration</code>通过加载构建配置类</p>
<p><code>SqlSessionFactoryBuilder</code>builder模式构建<code>SqlSessionFactory</code></p>
<p><code>SqlSessionFactory</code>中含有<code>Configuration</code>配置类</p>
<p>通过<code>SqlSessionFactory</code>获取<code>SqlSession</code>类</p>
<p><code>SqlSession</code>中含有<code>Executor</code>执行器和<code>Configuration</code>配置类</p>
<p><code>Executor</code>中含有<code>Transaction</code>负责管理事务</p>
<p>执行CRUD</p>
<p>如果失败使用<code>Transaction</code>回滚</p>
<p>如果成功将数据映射</p>
<p>关闭资源</p>
<h2 id="MyBatis缓存"><a href="#MyBatis缓存" class="headerlink" title="MyBatis缓存"></a>MyBatis缓存</h2><p>一级缓存：sqlsession级别的缓存。</p>
<p>二级缓存：mapper级别缓存，可以通过实现Cache来自定义缓存实现。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wanglu92.github.io/2021/01/15/Java%E6%B3%A8%E8%A7%A3%E5%92%8C%E5%8F%8D%E5%B0%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/15/Java%E6%B3%A8%E8%A7%A3%E5%92%8C%E5%8F%8D%E5%B0%84/" itemprop="url">Java注解和反射</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-15T21:52:40+08:00">
                2021-01-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><p>注解<code>annotation</code>：JDK5.0引入</p>
<p>注释<code>comment</code></p>
<h2 id="内置注解"><a href="#内置注解" class="headerlink" title="内置注解"></a>内置注解</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@Override 重写</span><br><span class="line">@deprecated 不推荐使用</span><br><span class="line">@SuppressWarnings 抑制警告</span><br></pre></td></tr></table></figure>
<h2 id="元注解"><a href="#元注解" class="headerlink" title="元注解"></a>元注解</h2><p>元注解：负责注解其他注解的注解，Java定义了4个次奥准的meta-annotation类型，用来提供对注解的说明。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Target 表示注解的使用范围</span><br><span class="line">@Retention 表示需要使用什么级别的注解 source &lt; class &lt; runtime</span><br><span class="line">@Document 说明该注解被包含在javadoc中</span><br><span class="line">@inherited 说明子类可以继承父类的注解</span><br></pre></td></tr></table></figure>
<p>@Target</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">package java.lang.annotation;</span><br><span class="line"></span><br><span class="line">public enum ElementType &#123;</span><br><span class="line">    &#x2F;** Class, interface (including annotation type), or enum declaration *&#x2F;</span><br><span class="line">    TYPE,</span><br><span class="line"></span><br><span class="line">    &#x2F;** Field declaration (includes enum constants) *&#x2F;</span><br><span class="line">    FIELD,</span><br><span class="line"></span><br><span class="line">    &#x2F;** Method declaration *&#x2F;</span><br><span class="line">    METHOD,</span><br><span class="line"></span><br><span class="line">    &#x2F;** Formal parameter declaration *&#x2F;</span><br><span class="line">    PARAMETER,</span><br><span class="line"></span><br><span class="line">    &#x2F;** Constructor declaration *&#x2F;</span><br><span class="line">    CONSTRUCTOR,</span><br><span class="line"></span><br><span class="line">    &#x2F;** Local variable declaration *&#x2F;</span><br><span class="line">    LOCAL_VARIABLE,</span><br><span class="line"></span><br><span class="line">    &#x2F;** Annotation type declaration *&#x2F;</span><br><span class="line">    ANNOTATION_TYPE,</span><br><span class="line"></span><br><span class="line">    &#x2F;** Package declaration *&#x2F;</span><br><span class="line">    PACKAGE,</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * Type parameter declaration</span><br><span class="line">     *</span><br><span class="line">     * @since 1.8</span><br><span class="line">     *&#x2F;</span><br><span class="line">    TYPE_PARAMETER,</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * Use of a type</span><br><span class="line">     *</span><br><span class="line">     * @since 1.8</span><br><span class="line">     *&#x2F;</span><br><span class="line">    TYPE_USE</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="自定义注解"><a href="#自定义注解" class="headerlink" title="自定义注解"></a>自定义注解</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package annotation;</span><br><span class="line"></span><br><span class="line">import java.lang.annotation.*;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author luu</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Target(value &#x3D; &#123;ElementType.TYPE, ElementType.METHOD, ElementType.FIELD&#125;)</span><br><span class="line">@Retention(value &#x3D; RetentionPolicy.RUNTIME)</span><br><span class="line">@Documented</span><br><span class="line">@Inherited</span><br><span class="line">public @interface MyAnnotation &#123;</span><br><span class="line"></span><br><span class="line">    String name() default &quot;&quot;;</span><br><span class="line">    </span><br><span class="line">    int age() default -1;</span><br><span class="line">    </span><br><span class="line">    String[] address();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果注解中只有一个值并命名为value，可以在使用注解的时候省略value，直接写赋值的内容。</p>
<h2 id="反射机制"><a href="#反射机制" class="headerlink" title="反射机制"></a>反射机制</h2><p><code>reflection</code>反射：允许程序在执行期间接住Reflection API取得任何类的内部信息，并能直接操作任意对象的内部属性及方法。</p>
<h3 id="获取Class的几种方法"><a href="#获取Class的几种方法" class="headerlink" title="获取Class的几种方法"></a>获取Class的几种方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">package reflection;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 23:30</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class GetClass &#123;</span><br><span class="line">    public static void main(String[] args) throws ClassNotFoundException &#123;</span><br><span class="line">        Class&lt;?&gt; clazz1 &#x3D; Class.forName(&quot;reflection.GetClass&quot;);</span><br><span class="line">        Class clazz2 &#x3D; GetClass.class;</span><br><span class="line">        Class clazz3 &#x3D; new GetClass().getClass();</span><br><span class="line">        Class clazz4 &#x3D; Integer.TYPE;</span><br><span class="line"></span><br><span class="line">        System.out.println(clazz1.hashCode());</span><br><span class="line">        System.out.println(clazz2.hashCode());</span><br><span class="line">        System.out.println(clazz3.hashCode());</span><br><span class="line">        System.out.println(clazz4);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="所有类型的Class"><a href="#所有类型的Class" class="headerlink" title="所有类型的Class"></a>所有类型的Class</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">package reflection;</span><br><span class="line"></span><br><span class="line">import java.lang.annotation.ElementType;</span><br><span class="line">import java.util.LinkedList;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 23:46</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class AllClassType &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        List&lt;Class&lt;?&gt;&gt; classes &#x3D; new LinkedList&lt;&gt;();</span><br><span class="line">        classes.add(Object.class);</span><br><span class="line">        classes.add(Runnable.class);</span><br><span class="line">        classes.add(String[].class);</span><br><span class="line">        classes.add(int[][].class);</span><br><span class="line">        classes.add(Override.class);</span><br><span class="line">        classes.add(ElementType.class);</span><br><span class="line">        classes.add(void.class);</span><br><span class="line">        classes.add(Integer.class);</span><br><span class="line">        classes.add(int.class);</span><br><span class="line">        classes.add(Class.class);</span><br><span class="line"></span><br><span class="line">        for (Class&lt;?&gt; aClass : classes) &#123;</span><br><span class="line">            System.out.println(aClass);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; output:</span><br><span class="line">class java.lang.Object</span><br><span class="line">interface java.lang.Runnable</span><br><span class="line">class [Ljava.lang.String;</span><br><span class="line">class [[I</span><br><span class="line">interface java.lang.Override</span><br><span class="line">class java.lang.annotation.ElementType</span><br><span class="line">void</span><br><span class="line">class java.lang.Integer</span><br><span class="line">int</span><br><span class="line">class java.lang.Class</span><br></pre></td></tr></table></figure>
<h2 id="类加载内存分析"><a href="#类加载内存分析" class="headerlink" title="类加载内存分析"></a>类加载内存分析</h2><p>Java内存</p>
<ul>
<li>堆</li>
<li>栈</li>
<li>方法区： 包含了class和static变量</li>
<li>静态方法去</li>
<li>程序计数器</li>
</ul>
<blockquote>
<p>类加载过程：加载、链接、初始化</p>
<ul>
<li>加载：将class文件字节码内容加载到内存中，并将这些静态数据转换成方法区的运行时数据结构，然后生成一个代码这个类的java.lang.Class对象。</li>
<li>链接：将Java类的二进制代码合并到JVM的运行状态之中的过程。<ul>
<li>验证：确保加载的类信息符合JVM规范，没有安全问题。</li>
<li>准备：正式为类变量分配内存并设置类变量的默认初始值，这些内存将在方法区进行分配。</li>
<li>解析：逊尼基常量池内的符号引用替换为直接引用的过程。</li>
</ul>
</li>
<li>初始化：<ul>
<li>执行类构造器方法。</li>
<li>当初始化一个类的时候，如果发现其父类还没有进行初始化，则需要先触发其父类的初始化。</li>
<li>虚拟机报账一个类的方法在多线程环境中被正确的加锁和同步。</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="类加载器"><a href="#类加载器" class="headerlink" title="类加载器"></a>类加载器</h2><ul>
<li><p><code>BootstrapClassloader</code>根类加载器，JVM自带类加载器，负责加载Java平台核心库类，无法直接获取。</p>
</li>
<li><p><code>ExtensionClassloader</code>扩展类加载器，负责jre/lib/ext目录下的jar包或-D java.ext.dirs知道目录下的jar包装入工作库</p>
</li>
<li><p><code>AppClassLoader</code>系统类就加载器，负责java -classpath或</p>
<p>-D java.class.path所指定的目录下的类与jar包装入工作，最常见的类加载器。</p>
</li>
<li><p>自定义类加载器</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package reflection;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-16 19:27</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class GetClassloader &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ClassLoader systemClassLoader &#x3D; GetClassloader.class.getClassLoader();</span><br><span class="line">        System.out.println(systemClassLoader);</span><br><span class="line"></span><br><span class="line">        ClassLoader parent &#x3D; systemClassLoader.getParent();</span><br><span class="line">        System.out.println(parent);</span><br><span class="line"></span><br><span class="line">        ClassLoader bootStrapClassloader &#x3D; parent.getParent();</span><br><span class="line">        System.out.println(bootStrapClassloader);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="获取类的信息"><a href="#获取类的信息" class="headerlink" title="获取类的信息"></a>获取类的信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">package reflection;</span><br><span class="line"></span><br><span class="line">import reflection.bean.Person;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-16 20:15</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class GetClassInfo &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Class&lt;Person&gt; clazz &#x3D; Person.class;</span><br><span class="line">        System.out.println(clazz.getName());</span><br><span class="line">        System.out.println(clazz.getCanonicalName());</span><br><span class="line">        System.out.println(clazz.getSimpleName());</span><br><span class="line">        System.out.println(clazz.getClassLoader());</span><br><span class="line">        System.out.println(clazz.getInterfaces());</span><br><span class="line">        System.out.println(clazz.getDeclaredAnnotations());</span><br><span class="line">        System.out.println(clazz.getConstructors());</span><br><span class="line">        System.out.println(clazz.getDeclaredAnnotations());</span><br><span class="line">        System.out.println(clazz.getFields());</span><br><span class="line">        System.out.println(clazz.getDeclaredFields());</span><br><span class="line">        System.out.println(clazz.getMethods());</span><br><span class="line">        System.out.println(clazz.getDeclaredMethods());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="通过反射动态创建对象"><a href="#通过反射动态创建对象" class="headerlink" title="通过反射动态创建对象"></a>通过反射动态创建对象</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">package reflection;</span><br><span class="line"></span><br><span class="line">import reflection.bean.Person;</span><br><span class="line"></span><br><span class="line">import java.lang.reflect.Constructor;</span><br><span class="line">import java.lang.reflect.Field;</span><br><span class="line">import java.lang.reflect.InvocationTargetException;</span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-16 20:48</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class GetInstance &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException, NoSuchFieldException &#123;</span><br><span class="line"></span><br><span class="line">        Class clazz &#x3D; Person.class;</span><br><span class="line">        &#x2F;&#x2F; 通用newInstance方法</span><br><span class="line">        Person person1 &#x3D; (Person) clazz.newInstance();</span><br><span class="line">        System.out.println(person1);</span><br><span class="line">        &#x2F;&#x2F; 通过构造方法</span><br><span class="line">        Constructor personConstructor &#x3D; clazz.getConstructor(Long.TYPE, String.class, Integer.TYPE, Date.class, Date.class);</span><br><span class="line">        Person person2 &#x3D; (Person) personConstructor.newInstance(1L, &quot;luu&quot;, 30, new Date(), new Date());</span><br><span class="line">        System.out.println(person2);</span><br><span class="line">        &#x2F;&#x2F; 修改字段</span><br><span class="line">        Field name &#x3D; clazz.getDeclaredField(&quot;name&quot;);</span><br><span class="line">        name.setAccessible(true);</span><br><span class="line">        name.set(person2, &quot;luu -&gt; lu&quot;);</span><br><span class="line">        name.setAccessible(false);</span><br><span class="line">        System.out.println(person2);</span><br><span class="line">        &#x2F;&#x2F; 调用方法</span><br><span class="line">        Method setName &#x3D; clazz.getMethod(&quot;setName&quot;, String.class);</span><br><span class="line">        setName.invoke(person2, &quot;lu -&gt; luu&quot;);</span><br><span class="line">        System.out.println(person2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="反射操作泛型"><a href="#反射操作泛型" class="headerlink" title="反射操作泛型"></a>反射操作泛型</h2><p>为了通过反射操作这些类，Java新增了<code>ParameterizedType</code> <code>GenericArrayType</code> <code>TypeVariable</code> <code>wildcardType</code>集中类型来代表不能被归一到Class类中的类型但是又和原始类型齐名的类型。</p>
<ul>
<li><code>ParameterizedType</code>：表示一种参数化类型，比如<code>Collection&lt;String&gt;</code></li>
<li><code>GenericArrayType</code>：表示一种元素类型是参数化类型或者类型变量的数组类型</li>
<li><code>TypeVariable</code>：是各种类型变量的公共父接口</li>
<li><code>wildcardType</code>：代表一种通配符类型表达式</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">package reflection;</span><br><span class="line"></span><br><span class="line">import reflection.bean.Person;</span><br><span class="line"></span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line">import java.lang.reflect.ParameterizedType;</span><br><span class="line">import java.lang.reflect.Type;</span><br><span class="line">import java.util.Arrays;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-16 21:16</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class GetGenericsByReflection&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    public void getInfo(T t) &#123;</span><br><span class="line">        System.out.println(t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void genericsParams(Map&lt;String, Person&gt; map, List&lt;Person&gt; list) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws NoSuchMethodException &#123;</span><br><span class="line">        Class clazz &#x3D; GetGenericsByReflection.class;</span><br><span class="line">        Method method &#x3D; clazz.getMethod(&quot;genericsParams&quot;, Map.class, List.class);</span><br><span class="line">        Type[] genericParameterTypes &#x3D; method.getGenericParameterTypes();</span><br><span class="line">        for (Type genericParameterType : genericParameterTypes) &#123;</span><br><span class="line">            if (genericParameterType instanceof ParameterizedType) &#123;</span><br><span class="line">                Type[] actualTypeArguments &#x3D; ((ParameterizedType) genericParameterType).getActualTypeArguments();</span><br><span class="line">                for (Type actualTypeArgument : actualTypeArguments) &#123;</span><br><span class="line">                    System.out.println(actualTypeArgument);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>并不能动态获取到运行时的类型，还是需要手动传入Class类来为运行时提供类型信息。只能够获取到编译期间的泛型信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Arrays;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-16 21:16</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class GetGenericsByReflection&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    public void getInfo(T t) &#123;</span><br><span class="line">        System.out.println(t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws NoSuchMethodException &#123;</span><br><span class="line">        GetGenericsByReflection&lt;String&gt; stringGetGenericsByReflection &#x3D; new GetGenericsByReflection&lt;&gt;();</span><br><span class="line">        Class clazz &#x3D; stringGetGenericsByReflection.getClass();</span><br><span class="line">        Method getInfo &#x3D; clazz.getMethod(&quot;getInfo&quot;, Object.class);</span><br><span class="line">        Type[] genericParameterTypes &#x3D; getInfo.getGenericParameterTypes();</span><br><span class="line">        System.out.println(Arrays.toString(genericParameterTypes));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="反射操作注解"><a href="#反射操作注解" class="headerlink" title="反射操作注解"></a>反射操作注解</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">package reflection;</span><br><span class="line"></span><br><span class="line">import java.lang.annotation.*;</span><br><span class="line">import java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-16 22:10</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class GetAnnotationByReflection &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IllegalAccessException &#123;</span><br><span class="line">        Person person &#x3D; new Person();</span><br><span class="line">        Person person1 &#x3D; GetAnnotationByReflection.annotationHandler(person, Person.class);</span><br><span class="line">        System.out.println(person1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static &lt;T&gt; T annotationHandler(T t, Class&lt;T&gt; tClass) throws IllegalAccessException &#123;</span><br><span class="line">        ClazzValue clazzValue &#x3D; tClass.getAnnotation(ClazzValue.class);</span><br><span class="line">        String instanceName &#x3D; clazzValue.value();</span><br><span class="line">        System.out.println(&quot;handler &quot; + instanceName + &quot; now&quot;);</span><br><span class="line">        Field[] fields &#x3D; tClass.getDeclaredFields();</span><br><span class="line">        for (Field field : fields) &#123;</span><br><span class="line">            if (field.isAnnotationPresent(ClazzField.class)) &#123;</span><br><span class="line">                ClazzField fieldAnnotation &#x3D; field.getAnnotation(ClazzField.class);</span><br><span class="line">                String value &#x3D; fieldAnnotation.value();</span><br><span class="line">                field.setAccessible(true);</span><br><span class="line">                field.set(t, value);</span><br><span class="line">                field.setAccessible(false);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return t;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@ClazzValue(&quot;person&quot;)</span><br><span class="line">class Person &#123;</span><br><span class="line">    @ClazzField(value &#x3D; &quot;luu&quot;)</span><br><span class="line">    private String name;</span><br><span class="line">    @ClazzField(value &#x3D; &quot;30&quot;)</span><br><span class="line">    private String age;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(String age) &#123;</span><br><span class="line">        this.age &#x3D; age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Person&#123;&quot; +</span><br><span class="line">                &quot;name&#x3D;&#39;&quot; + name + &#39;\&#39;&#39; +</span><br><span class="line">                &quot;, age&#x3D;&quot; + age +</span><br><span class="line">                &#39;&#125;&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author luu</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Target(ElementType.TYPE)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">@Documented</span><br><span class="line">@Inherited</span><br><span class="line">@interface ClazzValue &#123;</span><br><span class="line">    String value();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author luu</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Target(ElementType.FIELD)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">@Documented</span><br><span class="line">@Inherited</span><br><span class="line">@interface ClazzField &#123;</span><br><span class="line">    String value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wanglu92.github.io/2021/01/14/Java-I-O%E7%B3%BB%E7%BB%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/14/Java-I-O%E7%B3%BB%E7%BB%9F/" itemprop="url">Java I/O系统</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-14T16:51:43+08:00">
                2021-01-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>对于程序语言的设计者而言，创建一个好的输入输出<code>I/O</code>系统是一项艰难的任务。</p>
<h2 id="File类"><a href="#File类" class="headerlink" title="File类"></a>File类</h2><p>它既能代表一个特定文件的名称，又能够代表一个目录下的一组文件的名称。</p>
<p><code>File</code>类和<code>FilenameFilter</code>接口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public class TextFile &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        File path &#x3D; new File(&quot;.&quot;);</span><br><span class="line">        String[] list;</span><br><span class="line">        if(args.length &#x3D;&#x3D; 0) &#123;</span><br><span class="line">            list &#x3D; path.list();</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            list &#x3D; path.list(new DirFilter(args[0]));</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(list, String.CASE_INSENSITIVE_ORDER);</span><br><span class="line">        for (int i &#x3D; 0; i &lt; list.length; i++) &#123;</span><br><span class="line">            System.out.println(list[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class DirFilter implements FilenameFilter&#123;</span><br><span class="line"></span><br><span class="line">    private Pattern pattern;</span><br><span class="line"></span><br><span class="line">    public DirFilter(String regex) &#123;</span><br><span class="line">        this.pattern &#x3D; Pattern.compile(regex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean accept(File dir, String name) &#123;</span><br><span class="line">        return pattern.matcher(name).matches();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Directory用于获取regex匹配的文件名称</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">public class Directory &#123;</span><br><span class="line"></span><br><span class="line">    public static File[] local(File dir, final String regex) &#123;</span><br><span class="line">        return dir.listFiles(new FilenameFilter() &#123;</span><br><span class="line">            private Pattern pattern &#x3D; Pattern.compile(regex);</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public boolean accept(File dir, String name) &#123;</span><br><span class="line">                return pattern.matcher(new File(name).getName()).matches();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static File[] local(String path, final String regex) &#123;</span><br><span class="line">        return local(new File(path), regex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static TreeInfo walk(String start, String regex) &#123;</span><br><span class="line">        return recurseDirs(new File(start), regex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static TreeInfo walk(File start, String regex) &#123;</span><br><span class="line">        return recurseDirs(start, regex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static TreeInfo walk(File start) &#123;</span><br><span class="line">        return recurseDirs(start, &quot;.*&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static TreeInfo walk(String start) &#123;</span><br><span class="line">        return recurseDirs(new File(start), &quot;.*&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static TreeInfo recurseDirs(File startDir, String regex) &#123;</span><br><span class="line">        TreeInfo result &#x3D; new TreeInfo();</span><br><span class="line">        for (File item : Objects.requireNonNull(startDir.listFiles())) &#123;</span><br><span class="line">            if (item.isDirectory()) &#123;</span><br><span class="line">                result.dirs.add(item);</span><br><span class="line">                result.addAll(recurseDirs(item, regex));</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                if (item.getName().matches(regex)) &#123;</span><br><span class="line">                    result.files.add(item);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static class TreeInfo implements Iterable&lt;File&gt; &#123;</span><br><span class="line"></span><br><span class="line">        public List&lt;File&gt; files &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">        public List&lt;File&gt; dirs &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public Iterator&lt;File&gt; iterator() &#123;</span><br><span class="line">            return files.iterator();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        void addAll(TreeInfo other) &#123;</span><br><span class="line">            files.addAll(other.files);</span><br><span class="line">            dirs.addAll(other.dirs);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void forEach(Consumer&lt;? super File&gt; action) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public Spliterator&lt;File&gt; spliterator() &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public String toString() &#123;</span><br><span class="line">            return &quot;TreeInfo&#123;&quot; +</span><br><span class="line">                    &quot;files&#x3D;&quot; + files +</span><br><span class="line">                    &quot;, dirs&#x3D;&quot; + dirs +</span><br><span class="line">                    &#39;&#125;&#39;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * test</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        if (args.length &#x3D;&#x3D; 0) &#123;</span><br><span class="line">            System.out.println(walk(&quot;.&quot;));</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            for (String arg : args) &#123;</span><br><span class="line">                System.out.println(walk(arg));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据策略处理regex匹配到的文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">public class ProcessFiles &#123;</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 策略接口</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public interface Strategy &#123;</span><br><span class="line">        void process(File file);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private Strategy strategy;</span><br><span class="line">    private String ext;</span><br><span class="line"></span><br><span class="line">    public ProcessFiles(Strategy strategy, String ext) &#123;</span><br><span class="line">        this.strategy &#x3D; strategy;</span><br><span class="line">        this.ext &#x3D; ext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void start(String[] args) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            if (args.length &#x3D;&#x3D; 0) &#123;</span><br><span class="line">                processDirectoryTree(new File(&quot;.&quot;));</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                for (String arg : args) &#123;</span><br><span class="line">                    File fileArg &#x3D; new File(arg);</span><br><span class="line">                    if (fileArg.isDirectory()) &#123;</span><br><span class="line">                        processDirectoryTree(fileArg);</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        if (!arg.endsWith(&quot;.&quot; + ext)) &#123;</span><br><span class="line">                            arg +&#x3D; &quot;.&quot; + ext;</span><br><span class="line">                            strategy.process(new File(arg).getCanonicalFile());</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            throw new RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void processDirectoryTree(File root) &#123;</span><br><span class="line">        for (File file : Directory.walk(root.getAbsolutePath(), &quot;.*\\.&quot; + ext)) &#123;</span><br><span class="line">            strategy.process(file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * test</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        new ProcessFiles(System.out::println, &quot;java&quot;).start(args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>目录检查及创建</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class MakeDirectories &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        File file &#x3D; new File(&quot;src&#x2F;io&#x2F;MakeDirectories.java&quot;);</span><br><span class="line">        System.out.println(file.getAbsolutePath());</span><br><span class="line">        System.out.println(file.getName());</span><br><span class="line">        System.out.println(file.canWrite());</span><br><span class="line">        System.out.println(file.canRead());</span><br><span class="line">        System.out.println(file.length());</span><br><span class="line">        System.out.println(file.getParent());</span><br><span class="line">        System.out.println(file.isFile());</span><br><span class="line">        System.out.println(file.isDirectory());</span><br><span class="line">        System.out.println(file.lastModified());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="输入和输出"><a href="#输入和输出" class="headerlink" title="输入和输出"></a>输入和输出</h2><p>编程语言的I/O类库中常使用<strong>流</strong>这个概念，它代表任何有能力产出数据的数据源对象或者是有能力接收数据的接收端对象。<strong>流</strong>屏蔽了实际的I/O设备中处理数据的细节。</p>
<h3 id="InputStream类型"><a href="#InputStream类型" class="headerlink" title="InputStream类型"></a>InputStream类型</h3><p>Inputstream的作用是用来表示那些从不同数据源产生输入的类。</p>
<ol>
<li>字节数组</li>
<li>String</li>
<li>文件</li>
<li><strong>管道</strong>，工作方式与实际的管到类似，即，从一端输入，从另一端输出。</li>
<li>一个由其他种类的流组成的序列，以便我们可以将它们收集合并到一个流内。</li>
<li>其他数据源，如Internet连接等。</li>
</ol>
<table>
<thead>
<tr>
<th>类</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>ByteArrayInputStream</td>
<td>允许将内存的缓冲区当做InputStream使用</td>
</tr>
<tr>
<td>StringBufferInputStream</td>
<td>将String转换成InputStream</td>
</tr>
<tr>
<td>FileInputStream</td>
<td>用于从文件中读取信息</td>
</tr>
<tr>
<td>PipedInputStream</td>
<td>产生用于写入相关PipedOutputStream的数据。实现管道化概念</td>
</tr>
<tr>
<td>SequenceInputStream</td>
<td>将两个或多个InputStream对象转换成单一InputStream</td>
</tr>
<tr>
<td>FilterInputStream</td>
<td>抽象类，作为*<strong>装饰器**<em>的接口。其中</em></strong>装饰器***为其他InputStream的类提供有用功能</td>
</tr>
</tbody></table>
<h3 id="OutputStream类型"><a href="#OutputStream类型" class="headerlink" title="OutputStream类型"></a>OutputStream类型</h3><p>OutputStream决定了输出索要去往的目标：字节数组（但不是String，不过可以自己用字节数组创建String）、文件或管道。</p>
<table>
<thead>
<tr>
<th>类</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>ByteArrayOutputStream</td>
<td>在内存中创建缓冲区。所有送往**<em>流**</em>的数据都要放置在此缓冲区</td>
</tr>
<tr>
<td>FileOutputStream</td>
<td>用于将信息写入至文件</td>
</tr>
<tr>
<td>PipedOutputStream</td>
<td>任何写入其中的信息都会自动为相关PipedInputStream的输入。实现管道化概念</td>
</tr>
<tr>
<td>FilterOutputStream</td>
<td>抽象类，作为*<strong>装饰器**<em>的接口。其中，</em></strong>装饰器***为其他OutputStream提供有用的功能</td>
</tr>
</tbody></table>
<h2 id="添加属性和有用的接口"><a href="#添加属性和有用的接口" class="headerlink" title="添加属性和有用的接口"></a>添加属性和有用的接口</h2><p>FilterInputStream和FilterOutputStream是用来提供装饰器接口以控制特定输入流和输出流的两个类，他们的名字并不是很直观。</p>
<h3 id="通过FilterInputStream从InputStream读取数据"><a href="#通过FilterInputStream从InputStream读取数据" class="headerlink" title="通过FilterInputStream从InputStream读取数据"></a>通过FilterInputStream从InputStream读取数据</h3><p>FilterInputStream类型</p>
<table>
<thead>
<tr>
<th>类</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>DataInputStream</td>
<td>与DataOutputStream搭配使用，因此我们可以按照可移植方式从流读取基本数据类型<strong>int</strong>、<strong>char</strong>、<strong>long</strong>等</td>
</tr>
<tr>
<td>BufferedInputStream</td>
<td>使用它可以防止每次读取时都进行实际写操作，代表<strong>使用缓冲区</strong></td>
</tr>
<tr>
<td>LineNumberInputStream</td>
<td>跟踪输入流中的行号；可调用getLineNumber()和setLineNumber(int)</td>
</tr>
<tr>
<td>PushbackInputStream</td>
<td>具有<strong>能弹出一个字节的缓冲区</strong>。因此可以将读取到的最后一个字符回退</td>
</tr>
</tbody></table>
<h3 id="通过FilterOutputStream向OutputStream写入"><a href="#通过FilterOutputStream向OutputStream写入" class="headerlink" title="通过FilterOutputStream向OutputStream写入"></a>通过FilterOutputStream向OutputStream写入</h3><p>FilterOutputStream类型</p>
<table>
<thead>
<tr>
<th>类</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>DataOutputStream</td>
<td>与DataInputStream搭配使用，因此可以按照可移植方式向流中写入基本类型数据<strong>int</strong> <strong>char</strong> <strong>long</strong>等</td>
</tr>
<tr>
<td>PrintStream</td>
<td>用于产出格式化输出。其中DataOutputStream处理数据的存储，PrintStream处理显示</td>
</tr>
<tr>
<td>BufferedOutputStream</td>
<td>使用它以避免每次发送数据时都要要进行实际的操作。代表<strong>使用缓冲区</strong>。可以调用flush()清空缓冲区</td>
</tr>
</tbody></table>
<h2 id="Reader和Writer"><a href="#Reader和Writer" class="headerlink" title="Reader和Writer"></a>Reader和Writer</h2><p>Reader和Writer提供兼容Unicode与面向**<em>字符**</em>的I/O功能。</p>
<p>InputStream和OutputStream提供面向**<em>字节**</em>的功能。</p>
<h2 id="自我独立的类：RandomAccessFile"><a href="#自我独立的类：RandomAccessFile" class="headerlink" title="自我独立的类：RandomAccessFile"></a>自我独立的类：RandomAccessFile</h2><p>RandomAccessFile适用于由大小已经知道的记录组成的文件，所以我们可以使用seek()将记录从一处转移到另一处，然后读取或修改几率。文件中记录的大小不一定都相同，只要我们能够确定那些记录有多大以及他们在文件中的位置即可。</p>
<h2 id="I-O流的经典使用方式"><a href="#I-O流的经典使用方式" class="headerlink" title="I/O流的经典使用方式"></a>I/O流的经典使用方式</h2><p>尽管可以通过不同的方式组合I/O流类，但是我们可能也就只用到其中的几种组合。</p>
<h3 id="缓冲输入文件"><a href="#缓冲输入文件" class="headerlink" title="缓冲输入文件"></a>缓冲输入文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BufferedInputFile</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">read</span><span class="params">(String filename)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        BufferedReader in = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(filename));</span><br><span class="line">        String s;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">while</span>((s = in.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            sb.append(s).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        in.close();</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        System.out.println(read(<span class="string">&quot;src/io/BufferedInputFile.java&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="从内存中输入"><a href="#从内存中输入" class="headerlink" title="从内存中输入"></a>从内存中输入</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">package io;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.StringReader;</span><br><span class="line"></span><br><span class="line">public class MemoryInput &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        StringReader in &#x3D; new StringReader(BufferedInputFile.read(&quot;src&#x2F;io&#x2F;MemoryInput.java&quot;));</span><br><span class="line">        int c;</span><br><span class="line">        while ((c &#x3D; in.read()) !&#x3D; -1) &#123;</span><br><span class="line">            System.out.println((char) c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="格式化的内存输入"><a href="#格式化的内存输入" class="headerlink" title="格式化的内存输入"></a>格式化的内存输入</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package io;</span><br><span class="line"></span><br><span class="line">import java.io.ByteArrayInputStream;</span><br><span class="line">import java.io.DataInputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">public class FormattedMemoryInput &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            DataInputStream in &#x3D; new DataInputStream(new ByteArrayInputStream(BufferedInputFile.read(&quot;src&#x2F;io&#x2F;FormattedMemoryInput.java&quot;).getBytes()));</span><br><span class="line">            &#x2F;&#x2F; 检查剩余字符</span><br><span class="line">            while (in.available() !&#x3D; 0) &#123;</span><br><span class="line">                System.out.println((char) in.readByte());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="基本的文件输出"><a href="#基本的文件输出" class="headerlink" title="基本的文件输出"></a>基本的文件输出</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">package io;</span><br><span class="line"></span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class BasicFileOutput &#123;</span><br><span class="line"></span><br><span class="line">    static String file &#x3D; &quot;src&#x2F;io&#x2F;BasicFileOutput&quot;;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        BufferedReader in &#x3D; new BufferedReader(new StringReader(BufferedInputFile.read(&quot;src&#x2F;io&#x2F;BasicFileOutput.java&quot;)));</span><br><span class="line">        PrintWriter out &#x3D; new PrintWriter(new BufferedWriter(new FileWriter(file)));</span><br><span class="line">        int lineCount &#x3D; 1;</span><br><span class="line">        String s;</span><br><span class="line">        while((s &#x3D; in.readLine()) !&#x3D; null) &#123;</span><br><span class="line">            out.println(lineCount++ + &quot;: &quot; + s);</span><br><span class="line">        &#125;</span><br><span class="line">        out.close();</span><br><span class="line">        System.out.println(BufferedInputFile.read(&quot;src&#x2F;io&#x2F;BasicFileOutput&quot;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="文本文件输出的快捷方式"><a href="#文本文件输出的快捷方式" class="headerlink" title="文本文件输出的快捷方式"></a>文本文件输出的快捷方式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">package io;</span><br><span class="line"></span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class FileOutputShortcut &#123;</span><br><span class="line"></span><br><span class="line">    static String file &#x3D; &quot;src&#x2F;io&#x2F;FileOutputShortcut&quot;;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        BufferedReader in &#x3D; new BufferedReader(new StringReader(BufferedInputFile.read(&quot;src&#x2F;io&#x2F;FileOutputShortcut.java&quot;)));</span><br><span class="line">        PrintWriter out &#x3D; new PrintWriter(file);</span><br><span class="line">        int lineCount &#x3D; 1;</span><br><span class="line">        String s;</span><br><span class="line">        while ((s &#x3D; in.readLine()) !&#x3D; null) &#123;</span><br><span class="line">            out.println(lineCount++ + &quot;\t :&quot; + s);</span><br><span class="line">        &#125;</span><br><span class="line">        out.close();</span><br><span class="line">        System.out.println(BufferedInputFile.read(file));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="存储和恢复数据"><a href="#存储和恢复数据" class="headerlink" title="存储和恢复数据"></a>存储和恢复数据</h3><p>PrintWriter可以对数据进行格式化，以方便人们的阅读。但是为了输出可供另一个<strong>流</strong>恢复的数据，我们需要使用DataOutputStream写入数据，并用DataInputStream恢复数据。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package io;</span><br><span class="line"></span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class StoringAndRecoveringData &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        String filePath &#x3D; &quot;src&#x2F;io&#x2F;Data&quot;;</span><br><span class="line">        DataOutputStream out &#x3D; new DataOutputStream(new BufferedOutputStream(new FileOutputStream(filePath)));</span><br><span class="line">        out.writeDouble(3.1415926);</span><br><span class="line">        out.writeUTF(&quot;That was pi&quot;);</span><br><span class="line">        out.writeDouble(1.41413);</span><br><span class="line">        out.writeUTF(&quot;Square root of 2&quot;);</span><br><span class="line">        out.close();</span><br><span class="line">        DataInputStream in &#x3D; new DataInputStream(new BufferedInputStream(new FileInputStream(filePath)));</span><br><span class="line">        System.out.println(in.readDouble());</span><br><span class="line">        System.out.println(in.readUTF());</span><br><span class="line">        System.out.println(in.readDouble());</span><br><span class="line">        System.out.println(in.readUTF());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>保证数据一致性：</p>
<ol>
<li>为文件中的数据采用固定的格式</li>
<li>将额外的信息保存在文件中，以便能够对其进行解析以确定数据的存放位置</li>
</ol>
<h3 id="读写随机访问文件"><a href="#读写随机访问文件" class="headerlink" title="读写随机访问文件"></a>读写随机访问文件</h3><p>使用RandomAccessFile类</p>
<h3 id="管道流"><a href="#管道流" class="headerlink" title="管道流"></a>管道流</h3><p>PipedInputStream、PipedOutputStream、PipedReader和PipedWriter管道流用于任务之间的通信，在并发中使用。</p>
<h2 id="文件读写的实用工具"><a href="#文件读写的实用工具" class="headerlink" title="文件读写的实用工具"></a>文件读写的实用工具</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">package io;</span><br><span class="line"></span><br><span class="line">import java.io.*;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Arrays;</span><br><span class="line">import java.util.TreeSet;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 11:49</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class MyTextFile extends ArrayList&lt;String&gt; &#123;</span><br><span class="line"></span><br><span class="line">    public static String read(String fileName) &#123;</span><br><span class="line">        StringBuilder sb &#x3D; new StringBuilder();</span><br><span class="line">        try &#123;</span><br><span class="line">            try (BufferedReader in &#x3D; new BufferedReader(new FileReader(new File(fileName).getAbsoluteFile()))) &#123;</span><br><span class="line">                String s;</span><br><span class="line">                while ((s &#x3D; in.readLine()) !&#x3D; null) &#123;</span><br><span class="line">                    sb.append(s).append(&quot;\n&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            throw new RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">        return sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void write(String fileName, String text) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            try (PrintWriter out &#x3D; new PrintWriter(new File(fileName).getAbsoluteFile())) &#123;</span><br><span class="line">                out.print(text);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            throw new RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public MyTextFile(String fileName, String splitter) &#123;</span><br><span class="line">        super(Arrays.asList(read(fileName).split(splitter)));</span><br><span class="line">        if (&quot;&quot;.equals(get(0))) &#123;</span><br><span class="line">            remove(0);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public MyTextFile(String fileName) &#123;</span><br><span class="line">        this(fileName, &quot;\n&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void write(String fileName) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            try (PrintWriter out &#x3D; new PrintWriter(new File(fileName).getAbsoluteFile())) &#123;</span><br><span class="line">                for (String item : this) &#123;</span><br><span class="line">                    out.println(item);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            throw new RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        String file &#x3D; read(&quot;src&#x2F;io&#x2F;MyTextFile.java&quot;);</span><br><span class="line">        write(&quot;src&#x2F;io&#x2F;MyTextFile&quot;, file);</span><br><span class="line">        MyTextFile myTextFile &#x3D; new MyTextFile(&quot;src&#x2F;io&#x2F;MyTextFile&quot;);</span><br><span class="line">        myTextFile.write(&quot;src&#x2F;io&#x2F;MyTextFile2&quot;);</span><br><span class="line">        TreeSet&lt;String&gt; words &#x3D; new TreeSet&lt;&gt;(new MyTextFile(&quot;src&#x2F;io&#x2F;MyTextFile.java&quot;, &quot;\\W+&quot;));</span><br><span class="line">        System.out.println(words.headSet(&quot;a&quot;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="读取二进制文件"><a href="#读取二进制文件" class="headerlink" title="读取二进制文件"></a>读取二进制文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">package io;</span><br><span class="line"></span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class BinaryFile &#123;</span><br><span class="line"></span><br><span class="line">    public static byte[] read(File bFile) throws IOException &#123;</span><br><span class="line">        try (BufferedInputStream bf &#x3D; new BufferedInputStream(new FileInputStream(bFile))) &#123;</span><br><span class="line">            byte[] data &#x3D; new byte[bf.available()];</span><br><span class="line">            bf.read(data);</span><br><span class="line">            return data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static byte[] read(String bFile) throws IOException &#123;</span><br><span class="line">        return read(new File(bFile).getAbsoluteFile());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        byte[] read &#x3D; read(&quot;src&#x2F;io&#x2F;BinaryFile.java&quot;);</span><br><span class="line">        for (byte b : read) &#123;</span><br><span class="line">            System.out.println(b);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="标准I-O"><a href="#标准I-O" class="headerlink" title="标准I/O"></a>标准I/O</h2><p>标准I/O这个属于参考的是Unix中<strong>程序所使用的单一信息流</strong>的概念。</p>
<p>标准I/O的意义在于，我们可以很容易的把程序串联起来，一个程序的标准输出可以成为另一个程序的标准输入。这是一个强大的工具。</p>
<h3 id="从标准输入中读取"><a href="#从标准输入中读取" class="headerlink" title="从标准输入中读取"></a>从标准输入中读取</h3><p>按照标准I/O模型，Java提供了<code>System.in</code> <code>System.out</code> <code>System.err</code>。</p>
<h3 id="将System-out转换成PrintWriter"><a href="#将System-out转换成PrintWriter" class="headerlink" title="将System.out转换成PrintWriter"></a>将System.out转换成PrintWriter</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">package io;</span><br><span class="line"></span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line">public class ChangeSystemOut &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        PrintWriter out &#x3D; new PrintWriter(System.out, true);</span><br><span class="line">        out.println(&quot;Hello, world&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="标准I-O重定向"><a href="#标准I-O重定向" class="headerlink" title="标准I/O重定向"></a>标准I/O重定向</h3><p>Java的<code>System</code>类提供了简单的静态方法调用，以允许我们对标准输入、输出和错误I/O流进行重定向：</p>
<ul>
<li>setIn(InputStream)</li>
<li>setOut(PrintStream)</li>
<li>setErr(PrintStream)</li>
</ul>
<p>如果在显示器上创建大量输出，并且滚动太快以至于无法阅读，此时重定向就显得极为有用。</p>
<h2 id="进程控制"><a href="#进程控制" class="headerlink" title="进程控制"></a>进程控制</h2><p>经常会需要在Java内部执行其他操作系统程序，并且要控制这些程序的输入和输出。Java类库提供了执行这些操作的类<code>Process</code>类。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">package io;</span><br><span class="line"></span><br><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line">public class OSExecute &#123;</span><br><span class="line"></span><br><span class="line">    public static void command(String command) &#123;</span><br><span class="line">        boolean err &#x3D; false;</span><br><span class="line">        try &#123;</span><br><span class="line">            Process process &#x3D; new ProcessBuilder(command.split(&quot; &quot;)).start();</span><br><span class="line">            BufferedReader result &#x3D; new BufferedReader(new InputStreamReader(process.getInputStream()));</span><br><span class="line">            String s;</span><br><span class="line">            while((s &#x3D; result.readLine()) !&#x3D; null) &#123;</span><br><span class="line">                System.out.println(s);</span><br><span class="line">            &#125;</span><br><span class="line">            BufferedReader errors &#x3D; new BufferedReader(new InputStreamReader(process.getErrorStream()));</span><br><span class="line">            while((s &#x3D; errors.readLine()) !&#x3D; null) &#123;</span><br><span class="line">                System.out.println(s);</span><br><span class="line">                err &#x3D; true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            if(!command.startsWith(&quot;CMD &#x2F;C&quot;))&#123;</span><br><span class="line">                command(&quot;CMD &#x2F;C&quot; + command);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                throw new RuntimeException(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (err) &#123;</span><br><span class="line">            throw new RuntimeException(&quot;Errors executing &quot; + command);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        command(&quot;git status&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="新I-O"><a href="#新I-O" class="headerlink" title="新I/O"></a>新I/O</h2><p>JDK1.4中<code>java.nio.*</code>包中引入了新的JavaI/O类库，其目的在于提高速度。</p>
<p>速度的提高来自于所使用的的结构更接近于操作系统执行I/O的方式：<strong>通道</strong>和<strong>缓冲器</strong>。</p>
<p>唯一与<strong>通道</strong>打交道的是<strong>缓冲器</strong>``ByteBuffer`，使用时我们只需与<strong>缓冲器</strong>打交道。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">package io;</span><br><span class="line"></span><br><span class="line">import java.io.*;</span><br><span class="line">import java.nio.ByteBuffer;</span><br><span class="line">import java.nio.channels.FileChannel;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 13:11</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class GetChannel &#123;</span><br><span class="line"></span><br><span class="line">    private static final int BAIZE &#x3D; 1024;</span><br><span class="line">    private static final String FILE_PATH &#x3D; &quot;src&#x2F;io&#x2F;GetChannel&quot;;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        FileChannel fc &#x3D; new FileOutputStream(FILE_PATH).getChannel();</span><br><span class="line">        fc.write(ByteBuffer.wrap(&quot;Some text &quot;.getBytes()));</span><br><span class="line">        fc.close();</span><br><span class="line">        fc &#x3D; new RandomAccessFile(FILE_PATH, &quot;rw&quot;).getChannel();</span><br><span class="line">        fc.position(fc.size());</span><br><span class="line">        fc.write(ByteBuffer.wrap(&quot;Some more&quot;.getBytes()));</span><br><span class="line">        fc.close();</span><br><span class="line">        fc &#x3D; new FileInputStream(new File(FILE_PATH)).getChannel();</span><br><span class="line">        ByteBuffer buff &#x3D; ByteBuffer.allocate(BAIZE);</span><br><span class="line">        fc.read(buff);</span><br><span class="line">        buff.flip();</span><br><span class="line">        while (buff.hasRemaining()) &#123;</span><br><span class="line">            System.out.print((char) buff.get());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>ByteBuffer</code>使用<code>allocate()</code>方法来分配ByteBuffer。</p>
<p><code>ByteBuffer</code>需要调用<code>flip()</code>方法让它做好被别人读取的准备。</p>
<p><code>ByteBuffer</code>需要调用<code>clear()</code>方法清空<strong>缓冲器</strong>，让它为下一个read做好准备。</p>
<p><code>FileChannel.read()</code>返回<code>-1</code>时，表示已经到达了输入的末尾。</p>
<p>可以使用<code>transferTo()</code> <code>transferFrom()</code>方法将一个通道和另一个通道连接。</p>
<h3 id="转换数据"><a href="#转换数据" class="headerlink" title="转换数据"></a>转换数据</h3><p>使用<code>java.nio.charset.Charset</code>类，该类提供了把数据编码成多种不同类型的字符集工具。</p>
<h3 id="获取基本类型"><a href="#获取基本类型" class="headerlink" title="获取基本类型"></a>获取基本类型</h3><p>向<code>ByteBuffer</code>插入基本类型数据的最简单方法是利用<code>asCharBuffer()</code> <code>asShortBuffer()</code>等获取该缓冲器上的视图，然后使用视图上的put方法。</p>
<h3 id="视图缓冲器"><a href="#视图缓冲器" class="headerlink" title="视图缓冲器"></a>视图缓冲器</h3><p>视图缓冲器<code>view buffer</code>可以让我们通过某个特定的基本数据类型的视窗查看其地城的<code>ByteBuffer</code>。</p>
<h3 id="字节存放顺序"><a href="#字节存放顺序" class="headerlink" title="字节存放顺序"></a>字节存放顺序</h3><p>不同的机器可能会使用不同的字节排序方法来存储数据。<code>big endian</code>高位优先将最重要的字节存放在地址最低位的存储单元，<code>little endian</code>低位优先则是将最重要的字节放在地址最高的存储器单元。</p>
<p><code>ByteBuffer</code>默认是以高位优先的相识存储数据的。</p>
<p>我们可以使用<code>ByteOrder.BIG_ENDIAN</code>或<code>ByteOrder.LITTLE_ENDIAN</code>的<code>order()</code>方法改变其字节排列顺序。</p>
<h3 id="用缓冲器操纵数据"><a href="#用缓冲器操纵数据" class="headerlink" title="用缓冲器操纵数据"></a>用缓冲器操纵数据</h3><h3 id="缓冲器的细节"><a href="#缓冲器的细节" class="headerlink" title="缓冲器的细节"></a>缓冲器的细节</h3><h3 id="内存映射文件"><a href="#内存映射文件" class="headerlink" title="内存映射文件"></a>内存映射文件</h3><p>内存映射文件允许我们创建和修改哪些因为太大而不能存入内存的文件。</p>
<h3 id="文件加锁"><a href="#文件加锁" class="headerlink" title="文件加锁"></a>文件加锁</h3><p>JDK1.4引入了文件加锁机制，运维我们同步访问某个作为共享资源的文件。</p>
<p>文件锁对于其他的操作系统进程是可见的，因为Java的文件加锁直接映射到了本地操作系统的加锁工具。</p>
<h3 id="对映射文件的部分加锁"><a href="#对映射文件的部分加锁" class="headerlink" title="对映射文件的部分加锁"></a>对映射文件的部分加锁</h3><p>文件映射通常应用于极大的文件。我们可能需要对这种巨大的文件进行部分加锁，以便其他的进程可以修改文件中未被加锁的部分。例如数据库就是这样，因此过个用户可以同时访问他。</p>
<h2 id="压缩"><a href="#压缩" class="headerlink" title="压缩"></a>压缩</h2><p>Java I/O类库中的类支持读写压缩格式的数据流。</p>
<table>
<thead>
<tr>
<th>压缩类</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>CheckedInputStream</td>
<td>GetCheckSum()为任何InputStream产生校验和</td>
</tr>
<tr>
<td>CheckedOutputStream</td>
<td>GetCheckSum()为任何OutputStream产生校验和</td>
</tr>
<tr>
<td>DeflaterOutputStream</td>
<td>压缩类的基类</td>
</tr>
<tr>
<td>ZipOutputStream</td>
<td>一个DeflaterOutputStream，用于将数据压缩成Zip文件格式</td>
</tr>
<tr>
<td>GZIPOutputStream</td>
<td>一个DeflaterOutputStream，用于将数据压缩成GZIP文件格式</td>
</tr>
<tr>
<td>InflaterInputStream</td>
<td>解压类的基类</td>
</tr>
<tr>
<td>ZipInputStream</td>
<td>一个InflaterInputStream，用于解压Zip文件格式的数据</td>
</tr>
<tr>
<td>GZIPInputStream</td>
<td>一个InflaterInputStream，用于解压GZIP文件格式的数据</td>
</tr>
</tbody></table>
<h3 id="用GZIP进行简单的压缩"><a href="#用GZIP进行简单的压缩" class="headerlink" title="用GZIP进行简单的压缩"></a>用GZIP进行简单的压缩</h3><p>压缩类的使用非常直观，直接将输出流封装成GZIPOutputStream或ZipOutputStream，并将输入流封装成GZIPInputStream或ZipInputStream即可。</p>
<h3 id="用Zip进行多文件保存"><a href="#用Zip进行多文件保存" class="headerlink" title="用Zip进行多文件保存"></a>用Zip进行多文件保存</h3><h3 id="Java档案文件"><a href="#Java档案文件" class="headerlink" title="Java档案文件"></a>Java档案文件</h3><p>Zip格式也被应用JAR<code>Java Archive</code>Java档案文件格式中。</p>
<h2 id="对象序列化"><a href="#对象序列化" class="headerlink" title="对象序列化"></a>对象序列化</h2><p>Java的**<em>对象序列化**</em>将那些实现了<strong>Serializable</strong>接口的对象转换成一个字节序列，并能够在以后将这个字节序列完全恢复为原来的对象。</p>
<p>序列化机制能够自动弥补不同操作系统之间的差异。</p>
<p>对象的序列化的概念加入到语言中是为了支持两种主要特性。一是Java的远程方法调用，二是Java Bean来说，对象的序列化是必须的。</p>
<h2 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h2><p>对象序列化的一个重要限制是它只是Java的解决方案，只有Java程序才能反序列化这种对象。</p>
<p>一种更具通用性的解决方案是将数据转换为XML格式，这可以使其被各种各样的平台和语言使用。</p>
<h2 id="Preferences"><a href="#Preferences" class="headerlink" title="Preferences"></a>Preferences</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wanglu92.github.io/2021/01/14/Java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/14/Java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" itemprop="url">Java网络编程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-14T09:11:58+08:00">
                2021-01-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="什么是网络编程"><a href="#什么是网络编程" class="headerlink" title="什么是网络编程"></a>什么是网络编程</h2><p>packet包和邮件的思想类似</p>
<p>TCP连接</p>
<p>UDP连接</p>
<ul>
<li><p>计算机网络：计算机网络是指将地理位置不同的具有独立功能的多台计算机及其外部设备，通过通信线路连接起来，在网络操作系统，网络管理软件及网络通信协议的管理和协调下，实现资源共享和信息传递的计算机系统。（不同地理位置计算机，通过线路连接，在通信软件和协议的协调下，实现资源共享）</p>
</li>
<li><p>网络编程的目的：传播交流信息、数据交换、通信</p>
</li>
<li><p>需要解决的问题：</p>
<ul>
<li>如何准确的定位到网络上的一台主机，端口，定位到计算机上的某个资源</li>
<li>找到这个主机，如何传输资源。</li>
</ul>
</li>
</ul>
<p>JavaWeb：网页编程 B/S</p>
<p>网络编程：TCP/IP</p>
<h2 id="网络通信的要素"><a href="#网络通信的要素" class="headerlink" title="网络通信的要素"></a>网络通信的要素</h2><p>通信双方地址</p>
<ul>
<li>ip</li>
<li>端口号</li>
</ul>
<p>规则：网络通信协议</p>
<ul>
<li>TCP/IP四层模型</li>
<li>OSI七层网络模型</li>
</ul>
<p><img src="Java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/v2-1578921092d775e024345fa8a531a85e_1440w.jpg" alt="img"></p>
<h2 id="IP"><a href="#IP" class="headerlink" title="IP"></a>IP</h2><p>ip地址：InetAdress</p>
<ul>
<li>唯一定位一台网络上的计算机</li>
<li>127.0.0.1：本机localhost，本机回环地址</li>
<li>IP地址：<ul>
<li>IPV4/IPV6<ul>
<li>IPV4：127.0.0.1 4个字节组成 0-255，42亿个，30亿在北美，亚洲4亿，2011年用尽。</li>
<li>IPV6：fe80::489:aab1:a507:2b83%en0，128位，8个无符号整数。</li>
</ul>
</li>
<li>公网（互联网）-私网（局域网）<ul>
<li>129.168.xx.xx专门给组织内部使用的</li>
<li>ABCDE类地址计算：对半分，可以计算出来，阿里的笔试题中有。</li>
</ul>
</li>
</ul>
</li>
<li>域名：记忆问题引入域名。</li>
</ul>
<h2 id="端口"><a href="#端口" class="headerlink" title="端口"></a>端口</h2><p>端口：表示计算机上的每一个程序的进程</p>
<ul>
<li>不同的进程有不同的端口号。用来区分软件。</li>
<li>端口被规定0-65535</li>
<li>TCP端口、UDP端口。65535*2，tcp和udp的端口号不冲突。</li>
<li>端口分类<ul>
<li>公有端口0~1023<ul>
<li>HTTP：80</li>
<li>HTTPS：443</li>
<li>FTP：21</li>
<li>Telent：23</li>
</ul>
</li>
<li>程序注册端口：1024~49151，分配给用户或者程序<ul>
<li>Tomcat：8080</li>
<li>MySql：3306</li>
<li>Oracle：1521</li>
</ul>
</li>
<li>动态、私有端口：49512~65535<ul>
<li><code>lsof</code>  查看端口</li>
<li><code>leof -i:8080 </code>查看指定端口被占用情况</li>
<li><code>kill pid</code>杀死对应端口进程</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="通信协议"><a href="#通信协议" class="headerlink" title="通信协议"></a>通信协议</h2><p>协议：TCP/IP协议</p>
<p>网络通信协议：速率、传输码率、代码结构、传输控制等</p>
<p>TCP/IP协议簇：实际上是一组协议</p>
<ul>
<li>TCP：用户传输协议</li>
<li>UDP：用户数据报协议</li>
<li>IP：网络互连协议</li>
</ul>
<p>TCP和UDP对比：</p>
<p>TCP：</p>
<ul>
<li>连接、文档</li>
<li>三次握手 四次挥手</li>
<li>客户端、服务端</li>
<li>传输完成，释放连接、效率低</li>
</ul>
<p>UDP：</p>
<ul>
<li>不连接、不稳定</li>
<li>客户端、服务端，没有明确界限</li>
<li>不管有没有准备好，都可以发送</li>
<li>DDoS攻击：网络阻塞，导致端口不可用</li>
</ul>
<h2 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h2><p>客户端Client</p>
<ul>
<li>连接服务器Socket</li>
<li>发送消息</li>
</ul>
<p>服务器Server</p>
<ul>
<li>建立服务的端口ServerSocket</li>
<li>等待用户的连接，accept</li>
<li>接收用户的消息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">服务端：</span><br><span class="line">public class Server &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ServerSocket serverSocket &#x3D; null;</span><br><span class="line">        Socket socket &#x3D; null;</span><br><span class="line">        InputStream inputStream &#x3D; null;</span><br><span class="line">        ByteOutputStream byteOutputStream &#x3D; null;</span><br><span class="line">        try &#123;</span><br><span class="line">            serverSocket &#x3D; new ServerSocket(12340);</span><br><span class="line">            while (true) &#123;</span><br><span class="line">                socket &#x3D; serverSocket.accept();</span><br><span class="line">                inputStream &#x3D; socket.getInputStream();</span><br><span class="line">                byteOutputStream &#x3D; new ByteOutputStream();</span><br><span class="line">                byte[] buffer &#x3D; new byte[1024];</span><br><span class="line">                int length &#x3D; 0;</span><br><span class="line">                while ((length &#x3D; inputStream.read(buffer)) !&#x3D; -1) &#123;</span><br><span class="line">                    byteOutputStream.write(buffer, 0, length);</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(byteOutputStream.toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            throw new RuntimeException(e);</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            if (byteOutputStream !&#x3D; null) &#123;</span><br><span class="line">                byteOutputStream.close();</span><br><span class="line">            &#125;</span><br><span class="line">            if (inputStream !&#x3D; null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    inputStream.close();</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (socket !&#x3D; null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    socket.close();</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (serverSocket !&#x3D; null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    serverSocket.close();</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">客户端：</span><br><span class="line">public class Client &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        InetAddress localHost &#x3D; InetAddress.getLocalHost();</span><br><span class="line">        Socket socket &#x3D; new Socket(localHost, 12340);</span><br><span class="line">        OutputStream outputStream &#x3D; socket.getOutputStream();</span><br><span class="line">        outputStream.write(&quot;hello&quot;.getBytes());</span><br><span class="line">        outputStream.close();</span><br><span class="line">        socket.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发送文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">package network.FileDownLoad;</span><br><span class="line"></span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.io.OutputStream;</span><br><span class="line">import java.net.ServerSocket;</span><br><span class="line">import java.net.Socket;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 16:43</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class DownloadFile &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        &#x2F;&#x2F; 建立一个socket服务器</span><br><span class="line">        ServerSocket serverSocket &#x3D; new ServerSocket(9999);</span><br><span class="line">        &#x2F;&#x2F; 等待获取连接</span><br><span class="line">        Socket socket &#x3D; serverSocket.accept();</span><br><span class="line">        &#x2F;&#x2F; 获取socket的资源</span><br><span class="line">        InputStream socketIn &#x3D; socket.getInputStream();</span><br><span class="line">        &#x2F;&#x2F; 将文件存储</span><br><span class="line">        FileOutputStream fileOut &#x3D; new FileOutputStream(&quot;copyPicture.jpeg&quot;);</span><br><span class="line">        byte[] buffer &#x3D; new byte[1024];</span><br><span class="line">        int length &#x3D; 0;</span><br><span class="line">        while ((length &#x3D; socketIn.read(buffer)) !&#x3D; -1) &#123;</span><br><span class="line">            fileOut.write(buffer, 0 , length);</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 存储成功通知</span><br><span class="line">        OutputStream socketOut &#x3D; socket.getOutputStream();</span><br><span class="line">        socketOut.write(&quot;上传成功！&quot;.getBytes());</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 关闭资源</span><br><span class="line">        socketOut.close();</span><br><span class="line">        fileOut.close();</span><br><span class="line">        socketIn.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">package network.FileDownLoad;</span><br><span class="line"></span><br><span class="line">import java.io.*;</span><br><span class="line">import java.net.InetAddress;</span><br><span class="line">import java.net.Socket;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 16:42</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class UploadFile &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        &#x2F;&#x2F; 建立socket连接</span><br><span class="line">        Socket socket &#x3D; new Socket(InetAddress.getByName(&quot;127.0.0.1&quot;), 9999);</span><br><span class="line">        &#x2F;&#x2F; 获取上传的文件</span><br><span class="line">        FileInputStream fileIn &#x3D; new FileInputStream(&quot;myPicture.jpeg&quot;);</span><br><span class="line">        &#x2F;&#x2F; 上传</span><br><span class="line">        byte[] buffer &#x3D; new byte[1024];</span><br><span class="line">        int length &#x3D; 0;</span><br><span class="line">        OutputStream socketOut &#x3D; socket.getOutputStream();</span><br><span class="line">        while ((length &#x3D; fileIn.read(buffer)) !&#x3D; -1) &#123;</span><br><span class="line">            socketOut.write(buffer, 0, length);</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 上传成功关闭输出流</span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line">        &#x2F;&#x2F; 等待服务器通知</span><br><span class="line">        InputStream socketIn &#x3D; socket.getInputStream();</span><br><span class="line">        ByteArrayOutputStream out &#x3D; new ByteArrayOutputStream();</span><br><span class="line">        while ((length &#x3D; socketIn.read(buffer)) !&#x3D; -1) &#123;</span><br><span class="line">            out.write(buffer, 0, length);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(out.toString());</span><br><span class="line">        &#x2F;&#x2F; 关闭资源</span><br><span class="line">        out.close();</span><br><span class="line">        socketIn.close();</span><br><span class="line">        fileIn.close();</span><br><span class="line">        socket.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h2><p>服务端</p>
<h2 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h2><p>不用连接，需要知道对方的地址。</p>
<ul>
<li><code>DatagramPacket</code>数据报包</li>
<li><code>DatagramSocket</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package network.udp;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.net.*;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 18:14</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class UDPClientOne &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        DatagramSocket datagramSocket &#x3D; new DatagramSocket(9999);</span><br><span class="line">        String words &#x3D; &quot;hello world&quot;;</span><br><span class="line">        DatagramPacket datagramPacket &#x3D; new DatagramPacket(words.getBytes(), 0, words.length(), InetAddress.getByName(&quot;127.0.0.1&quot;), 9998);</span><br><span class="line">        datagramSocket.send(datagramPacket);</span><br><span class="line">        datagramSocket.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package network.udp;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.net.DatagramPacket;</span><br><span class="line">import java.net.DatagramSocket;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 18:14</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class UDPClientTwo &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        DatagramSocket datagramSocket &#x3D; new DatagramSocket(9998);</span><br><span class="line">        byte[] buffer &#x3D; new byte[1024];</span><br><span class="line">        DatagramPacket datagramPacket &#x3D; new DatagramPacket(buffer, 0, buffer.length);</span><br><span class="line">        datagramSocket.receive(datagramPacket);</span><br><span class="line">        System.out.println(new String(datagramPacket.getData()));</span><br><span class="line">        datagramSocket.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>聊天程序</p>
<p>发送消息类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">package network.chat;</span><br><span class="line"></span><br><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line">import java.net.DatagramPacket;</span><br><span class="line">import java.net.DatagramSocket;</span><br><span class="line">import java.net.InetAddress;</span><br><span class="line">import java.net.SocketException;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 20:25</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class Send implements Runnable &#123;</span><br><span class="line"></span><br><span class="line">    private DatagramSocket datagramSocket;</span><br><span class="line">    private String toIP;</span><br><span class="line">    private int toPort;</span><br><span class="line">    private String nickName;</span><br><span class="line"></span><br><span class="line">    public Send(String toIP, int toPort, int ownPort, String nickName) &#123;</span><br><span class="line">        this.toIP &#x3D; toIP;</span><br><span class="line">        this.toPort &#x3D; toPort;</span><br><span class="line">        this.nickName &#x3D; nickName;</span><br><span class="line">        try &#123;</span><br><span class="line">            this.datagramSocket &#x3D; new DatagramSocket(ownPort);</span><br><span class="line">        &#125; catch (SocketException e) &#123;</span><br><span class="line">            throw new RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        String message;</span><br><span class="line">        BufferedReader in &#x3D; new BufferedReader(new InputStreamReader(System.in));</span><br><span class="line">        try &#123;</span><br><span class="line">            while (true) &#123;</span><br><span class="line">                byte[] messages &#x3D; (nickName + &quot; : &quot; + in.readLine()).getBytes();</span><br><span class="line">                DatagramPacket datagramPacket &#x3D; new DatagramPacket(messages, messages.length, InetAddress.getByName(toIP), toPort);</span><br><span class="line">                datagramSocket.send(datagramPacket);</span><br><span class="line">                System.out.println(&quot;发送到&quot; + toIP + &quot;:&quot; + toPort + &quot;，消息&quot; + &quot; - &quot; + new String(datagramPacket.getData()) + &quot; - &quot; + &quot;发送成功！&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            throw new RuntimeException(e);</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            datagramSocket.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接收消息类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">package network.chat;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.net.DatagramPacket;</span><br><span class="line">import java.net.DatagramSocket;</span><br><span class="line">import java.net.SocketException;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 20:26</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class Receive implements Runnable &#123;</span><br><span class="line"></span><br><span class="line">    private DatagramSocket datagramSocket;</span><br><span class="line"></span><br><span class="line">    public Receive(int ownIp) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            this.datagramSocket &#x3D; new DatagramSocket(ownIp);</span><br><span class="line">        &#125; catch (SocketException e) &#123;</span><br><span class="line">            throw new RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        byte[] buffer &#x3D; new byte[2048];</span><br><span class="line">        try &#123;</span><br><span class="line">            while (true) &#123;</span><br><span class="line">                DatagramPacket datagramPacket &#x3D; new DatagramPacket(buffer, buffer.length);</span><br><span class="line">                datagramSocket.receive(datagramPacket);</span><br><span class="line">                System.out.println(new String(datagramPacket.getData(), 0, datagramPacket.getLength()));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            throw new RuntimeException(e);</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            datagramSocket.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>客户端一</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">package network.chat;</span><br><span class="line"></span><br><span class="line">import java.util.concurrent.ExecutorService;</span><br><span class="line">import java.util.concurrent.Executors;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 21:04</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class ChatOne &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ExecutorService threadPool &#x3D; Executors.newFixedThreadPool(2);</span><br><span class="line">        threadPool.submit(new Send(&quot;127.0.0.1&quot;, 11001, 11002, &quot;小王&quot;));</span><br><span class="line">        threadPool.submit(new Receive(11000));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>客户端二</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">package network.chat;</span><br><span class="line"></span><br><span class="line">import java.util.concurrent.ExecutorService;</span><br><span class="line">import java.util.concurrent.Executors;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 21:11</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class ChatTwo &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ExecutorService threadPool &#x3D; Executors.newFixedThreadPool(2);</span><br><span class="line">        threadPool.submit(new Send(&quot;127.0.0.1&quot;, 11000, 11003, &quot;小张&quot;));</span><br><span class="line">        threadPool.submit(new Receive(11001));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p>统一资源定位符：定位资源，定位互联网上的某一个资源。</p>
<p><code>https://www.baidu.com</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">协议:&#x2F;&#x2F;IP地址:端口&#x2F;资源&#x2F;参数</span><br></pre></td></tr></table></figure>
<p>下载网络资源</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package network;</span><br><span class="line"></span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.net.MalformedURLException;</span><br><span class="line">import java.net.URL;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author: luu</span><br><span class="line"> * @date: 2021-01-15 21:39</span><br><span class="line"> **&#x2F;</span><br><span class="line">public class UrlDownload &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        URL url &#x3D; new URL(&quot;https:&#x2F;&#x2F;m10.music.126.net&#x2F;20210115220624&#x2F;95a4f4eded8f5d962ff157686275f38d&#x2F;yyaac&#x2F;0708&#x2F;0652&#x2F;0508&#x2F;0b9b6827b718aa223af92bd52aa2424f.m4a&quot;);</span><br><span class="line">        InputStream in &#x3D; url.openStream();</span><br><span class="line">        FileOutputStream out &#x3D; new FileOutputStream(&quot;世间美好与你环环相扣.m4a&quot;);</span><br><span class="line">        byte[] buffer &#x3D; new byte[2048];</span><br><span class="line">        int length &#x3D; 0;</span><br><span class="line">        while ((length &#x3D; in.read(buffer)) !&#x3D; -1) &#123;</span><br><span class="line">            out.write(buffer, 0, length);</span><br><span class="line">        &#125;</span><br><span class="line">        out.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wanglu92.github.io/2021/01/13/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/13/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B/" itemprop="url">Java多线程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-13T14:28:19+08:00">
                2021-01-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="进程、线程、多线程"><a href="#进程、线程、多线程" class="headerlink" title="进程、线程、多线程"></a>进程、线程、多线程</h2><ul>
<li><p>进程<code>process</code>，译作进程，是计算机中已运行程序的实体。进程本身不会运行，是线程的容器。程序本身只是指令的集合，进程才是程序(那些指令)的真正运行。若干进程有可能与同一个程序相关系，且每个进程皆可以同步(循序)或不同步(平行)的方式独立运行。进程为现今分时系统的基本运作单位。</p>
</li>
<li><p>线程<code>thread</code>，操作系统技术中的术语，是操作系统能够进行运算调度的最小单位。它被包涵在进程之中，一条线程指的是进程中一个单一顺序的控制流，一个进程中可以并发多个线程，每条线程并行执行不同的任务。在Unix System V及SunOS中也被称为轻量进程(lightweight processes)，但轻量进程更多指内核线程(kernel thread)，而把用户线程(user thread)称为线程。</p>
</li>
<li><p>多线程，最开始，线程只是用于分配单个处理器的处理时间的一种工具。但假如操作系统本身支持多个处理器，那么每个线程都可分配给一个不同的处理器，真正进入“并行运算”状态。从程序设计语言的角度看，多线程操作最有价值的特性之一就是程序员不必关心到底使用了多少个处理器。程序在逻辑意义上被分割为数个线程;假如机器本身安装了多个处理器，那么程序会运行得更快，毋需作出任何特殊的调校。多线程是为了同步完成多项任务，不是为了提高运行效率，而是为了提高资源使用效率来提高系统的效率。线程是在同一时间需要完成多项任务的时候实现的。</p>
</li>
</ul>
<h2 id="线程的实现"><a href="#线程的实现" class="headerlink" title="线程的实现"></a>线程的实现</h2><p>继承Thread类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;my thread&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread myThread = <span class="keyword">new</span> MyThread();</span><br><span class="line">        myThread.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现Runnable接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ublic <span class="class"><span class="keyword">class</span> <span class="title">MyRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(Thread.currentThread().getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyRunnable myRunnable = <span class="keyword">new</span> MyRunnable();</span><br><span class="line">        Thread thread = <span class="keyword">new</span> Thread(myRunnable, <span class="string">&quot;my runnable&quot;</span>);</span><br><span class="line">        thread.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现Callable接口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class MyCallable implements Callable&lt;String&gt; &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String call() throws Exception &#123;</span><br><span class="line">        return Thread.currentThread().getName();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws ExecutionException, InterruptedException &#123;</span><br><span class="line">        ExecutorService executorService &#x3D; Executors.newCachedThreadPool();</span><br><span class="line">        Future&lt;String&gt; submit &#x3D; executorService.submit(new MyCallable());</span><br><span class="line">        String s &#x3D; submit.get();</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="线程的状态"><a href="#线程的状态" class="headerlink" title="线程的状态"></a>线程的状态</h2><p>线程有六种状态，分别如下，可以通过Thread中的State内部枚举类来查看：</p>
<ul>
<li>NEW：尚未启动的线程处于此状态</li>
<li>RUNNABLE：在Java虚拟机中执行的线程处于此状态</li>
<li>BLOCKED：被阻塞等待监视器锁定的线程处于此状态</li>
<li>WAITING：正在等待另一个线程执行特定动作的线程处于此状态</li>
<li>TIMED_WAITING：正在等待另一个线程执行动作达到指定等待时间的线程处于此状态</li>
<li>TERMINATED：已退出的线程处于此状态</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public enum State &#123;  </span><br><span class="line">    NEW, &#x2F;&#x2F; 初始状态</span><br><span class="line">    RUNNABLE, &#x2F;&#x2F; 运行状态</span><br><span class="line">    BLOCKED, &#x2F;&#x2F; 阻塞状态</span><br><span class="line">    WAITING, &#x2F;&#x2F; 等待状态</span><br><span class="line">    TIMED_WAITING, &#x2F;&#x2F; 超时等待状态</span><br><span class="line">    TERMINATED; &#x2F;&#x2F; 终止状态</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/2021/01/13/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%8A%B6%E6%80%81.jpeg" class="" title="线程的状态">

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public class ThreadStatus implements Runnable &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Thread.sleep(100L);</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + &quot;执行完毕&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class="line">        Thread thread &#x3D; new Thread(new ThreadStatus(), &quot;线程状态测试 -- &quot;);</span><br><span class="line"></span><br><span class="line">        System.out.println(thread.getState());</span><br><span class="line"></span><br><span class="line">        thread.start();</span><br><span class="line">        System.out.println(thread.getState());</span><br><span class="line"></span><br><span class="line">        Thread.sleep(500L);</span><br><span class="line">        System.out.println(thread.getState());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="并发问题"><a href="#并发问题" class="headerlink" title="并发问题"></a>并发问题</h2><p>多个线程操作同时操作一个对象，线程不安全。</p>
<p>解决方法：线程同步。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">public class Concurrency implements Runnable &#123;</span><br><span class="line"></span><br><span class="line">    private int ticketCount &#x3D; 10;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        while (ticketCount &gt; 0 ) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                Thread.sleep(100L);</span><br><span class="line">            &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + &quot;获得票: &quot; + ticketCount--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Concurrency concurrency &#x3D; new Concurrency();</span><br><span class="line">        Thread thread1 &#x3D; new Thread(concurrency, &quot;1-&quot;);</span><br><span class="line">        Thread thread2 &#x3D; new Thread(concurrency, &quot;2-&quot;);</span><br><span class="line">        Thread thread3 &#x3D; new Thread(concurrency, &quot;3-&quot;);</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line">        thread3.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; output</span><br><span class="line">2-获得票: 9</span><br><span class="line">1-获得票: 10</span><br><span class="line">3-获得票: 9</span><br><span class="line">3-获得票: 8</span><br><span class="line">1-获得票: 7</span><br><span class="line">2-获得票: 6</span><br><span class="line">1-获得票: 5</span><br><span class="line">3-获得票: 4</span><br><span class="line">2-获得票: 3</span><br><span class="line">1-获得票: 2</span><br><span class="line">3-获得票: 1</span><br><span class="line">2-获得票: 0</span><br><span class="line">1-获得票: -1</span><br></pre></td></tr></table></figure>
<h2 id="Thread中的静态代理"><a href="#Thread中的静态代理" class="headerlink" title="Thread中的静态代理"></a>Thread中的静态代理</h2><p>静态代理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticProxy</span> <span class="keyword">implements</span> <span class="title">Sleep</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Myself myself;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StaticProxy</span><span class="params">(Myself myself)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myself = myself;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;先洗漱&quot;</span>);</span><br><span class="line">        myself.sleep();</span><br><span class="line">        System.out.println(<span class="string">&quot;睡醒整理床铺&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StaticProxy staticProxy = <span class="keyword">new</span> StaticProxy(<span class="keyword">new</span> Myself());</span><br><span class="line">        staticProxy.sleep();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Sleep</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Myself</span> <span class="keyword">implements</span> <span class="title">Sleep</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I sleep&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在Thread类内部使用了类似的方法，接收一个Runnable的实例。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Allocates a new &#123;<span class="doctag">@code</span> Thread&#125; object. This constructor has the same</span></span><br><span class="line"><span class="comment"> * effect as &#123;<span class="doctag">@linkplain</span> #Thread(ThreadGroup,Runnable,String) Thread&#125;</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> (null, target, gname)&#125;, where &#123;<span class="doctag">@code</span> gname&#125; is a newly generated</span></span><br><span class="line"><span class="comment"> * name. Automatically generated names are of the form</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> &quot;Thread-&quot;+&#125;&lt;i&gt;n&lt;/i&gt;, where &lt;i&gt;n&lt;/i&gt; is an integer.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  target</span></span><br><span class="line"><span class="comment"> *         the object whose &#123;<span class="doctag">@code</span> run&#125; method is invoked when this thread</span></span><br><span class="line"><span class="comment"> *         is started. If &#123;<span class="doctag">@code</span> null&#125;, this classes &#123;<span class="doctag">@code</span> run&#125; method does</span></span><br><span class="line"><span class="comment"> *         nothing.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Thread</span><span class="params">(Runnable target)</span> </span>&#123;</span><br><span class="line">    init(<span class="keyword">null</span>, target, <span class="string">&quot;Thread-&quot;</span> + nextThreadNum(), <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="线程停止"><a href="#线程停止" class="headerlink" title="线程停止"></a>线程停止</h2><p>线程停止不建议使用线程本身的stop、destroy方法，建议使用标记停止的方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyStopThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">boolean</span> run = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!run) &#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">100L</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        MyStopThread myStopThread = <span class="keyword">new</span> MyStopThread();</span><br><span class="line">        Thread thread = <span class="keyword">new</span> Thread(myStopThread, <span class="string">&quot;my stop thread&quot;</span>);</span><br><span class="line">        thread.start();</span><br><span class="line">        Thread.sleep(<span class="number">1000L</span>);</span><br><span class="line">        myStopThread.run = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="线程休眠、线程礼让、线程强制执行"><a href="#线程休眠、线程礼让、线程强制执行" class="headerlink" title="线程休眠、线程礼让、线程强制执行"></a>线程休眠、线程礼让、线程强制执行</h2><p>Thread.sleep线程休眠。</p>
<p>Object.yield线程礼让。</p>
<p>Thread.join线程强制执行，会中断当前的线程，强制执行join的线程到结束。</p>
<h2 id="线程的优先级"><a href="#线程的优先级" class="headerlink" title="线程的优先级"></a>线程的优先级</h2><p>Java提供一个线程调度器来监视程序中启动后进入就绪状态的多有线程，线程调度器按照优先级决定应该调度哪个线程来执行。</p>
<p>线程优先级用数字来表示，范围1~10。</p>
<p>使用getPriority获取线程优先级，使用setPriority来设置优先级，设置线程优先级需要在线程启动之前设置，否则无法生效。</p>
<p>并不是说优先级高的线程一定会先执行。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPriority</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;, priority: &quot;</span> + Thread.currentThread().getPriority());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List&lt;Thread&gt; threadList = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">            Thread thread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadPriority(), <span class="string">&quot;thread-&quot;</span> + i);</span><br><span class="line">            thread.setPriority(i);</span><br><span class="line">            threadList.add(thread);</span><br><span class="line">        &#125;</span><br><span class="line">        threadList.forEach(Thread::start);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// output:</span></span><br><span class="line">thread-<span class="number">1</span>, priority: <span class="number">1</span></span><br><span class="line">thread-<span class="number">4</span>, priority: <span class="number">4</span></span><br><span class="line">thread-<span class="number">3</span>, priority: <span class="number">3</span></span><br><span class="line">thread-<span class="number">2</span>, priority: <span class="number">2</span></span><br><span class="line">thread-<span class="number">5</span>, priority: <span class="number">5</span></span><br><span class="line">thread-<span class="number">6</span>, priority: <span class="number">6</span></span><br><span class="line">thread-<span class="number">7</span>, priority: <span class="number">7</span></span><br><span class="line">thread-<span class="number">8</span>, priority: <span class="number">8</span></span><br><span class="line">thread-<span class="number">9</span>, priority: <span class="number">9</span></span><br><span class="line">thread-<span class="number">10</span>, priority: <span class="number">10</span></span><br></pre></td></tr></table></figure>
<h2 id="守护线程"><a href="#守护线程" class="headerlink" title="守护线程"></a>守护线程</h2><p>线程分为用户线程和守护线程，虚拟机确保用户线程执行完毕，但不用等待守护线程执行完毕，守护线程如操作日志、监控内存、垃圾回收等</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaemonThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">100L</span>);</span><br><span class="line">                System.out.println(count++);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        DaemonThread daemonThread = <span class="keyword">new</span> DaemonThread();</span><br><span class="line">        Thread thread = <span class="keyword">new</span> Thread(daemonThread, <span class="string">&quot;daemonThread&quot;</span>);</span><br><span class="line">        thread.setDaemon(<span class="keyword">true</span>); <span class="comment">// 设置线程为守护线程</span></span><br><span class="line">        thread.start();</span><br><span class="line">        Thread.sleep(<span class="number">1000L</span>);</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; stop &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="并发"><a href="#并发" class="headerlink" title="并发"></a>并发</h2><p>同一个对象被多个线程同时操作。</p>
<p>处理多线程问题，多个线程访问同一个对象，并且会修改这个对象，需要用到线程同步，线程同步本质是一种等待机制，需要同时访问此对象的线程进入对象的等待池形成队列，等待前面的线程执行完毕，下一个线程再去执行。</p>
<p>线程同步：队列 + 锁，引入了锁机制<code>synchronized</code>，引入互斥锁后会出现以下问题：</p>
<ul>
<li>一个线程持有锁会导致其他所有需要此锁的线程挂起</li>
<li>在多线程竞争的条件下，加锁、释放锁会导致比较多的上下文切换和调度延迟，引起性能问题</li>
<li>如果一个优先级高的线程等待一个优先级低的线程释放锁，会导致优先级倒置，引起性能问题。</li>
</ul>
<h2 id="线程不安全案例"><a href="#线程不安全案例" class="headerlink" title="线程不安全案例"></a>线程不安全案例</h2><ul>
<li>抢购火车票</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">public class BuyTicket implements Runnable &#123;</span><br><span class="line"></span><br><span class="line">    private int ticketCount &#x3D; 10;</span><br><span class="line"></span><br><span class="line">    void buy () throws InterruptedException &#123;</span><br><span class="line">        while (ticketCount &gt; 0) &#123;</span><br><span class="line">            Thread.sleep(100L);</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + &quot; -&gt; 买到票&quot; + ticketCount +  &quot;，剩余:&quot; + --ticketCount);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            buy();</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        BuyTicket buyTicket &#x3D; new BuyTicket();</span><br><span class="line">        Thread thread1 &#x3D; new Thread(buyTicket, &quot;小明&quot;);</span><br><span class="line">        Thread thread2 &#x3D; new Thread(buyTicket, &quot;小王&quot;);</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; output</span><br><span class="line">小王 -&gt; 买到票10，剩余:9</span><br><span class="line">小明 -&gt; 买到票10，剩余:8</span><br><span class="line">小王 -&gt; 买到票8，剩余:7</span><br><span class="line">小明 -&gt; 买到票7，剩余:6</span><br><span class="line">小王 -&gt; 买到票6，剩余:5</span><br><span class="line">小明 -&gt; 买到票6，剩余:5</span><br><span class="line">小王 -&gt; 买到票5，剩余:4</span><br><span class="line">小明 -&gt; 买到票5，剩余:3</span><br><span class="line">小明 -&gt; 买到票3，剩余:2</span><br><span class="line">小王 -&gt; 买到票2，剩余:1</span><br><span class="line">小明 -&gt; 买到票1，剩余:0</span><br><span class="line">小王 -&gt; 买到票1，剩余:-1</span><br></pre></td></tr></table></figure>
<ul>
<li>银行统一账户多人同时取款</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">public class UnsafeBank &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Account account &#x3D; new Account(100, &quot;bank&quot;);</span><br><span class="line">        DrawingMoney one &#x3D; new DrawingMoney(account, 50, &quot;小明&quot;);</span><br><span class="line">        DrawingMoney two &#x3D; new DrawingMoney(account, 100, &quot;小王&quot;);</span><br><span class="line">        one.start();</span><br><span class="line">        two.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Account extends Thread &#123;</span><br><span class="line"></span><br><span class="line">    private int money;</span><br><span class="line">    private String userNumber;</span><br><span class="line"></span><br><span class="line">    public Account(int money, String userNumber) &#123;</span><br><span class="line">        this.money &#x3D; money;</span><br><span class="line">        this.userNumber &#x3D; userNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getMoney() &#123;</span><br><span class="line">        return money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setMoney(int money) &#123;</span><br><span class="line">        this.money &#x3D; money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getUserNumber() &#123;</span><br><span class="line">        return userNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUserNumber(String userNumber) &#123;</span><br><span class="line">        this.userNumber &#x3D; userNumber;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class DrawingMoney extends Thread &#123;</span><br><span class="line"></span><br><span class="line">    private Account account;</span><br><span class="line">    private int drawMoney;</span><br><span class="line"></span><br><span class="line">    public DrawingMoney(Account account, int drawMoney, String name) &#123;</span><br><span class="line">        super(name);</span><br><span class="line">        this.account &#x3D; account;</span><br><span class="line">        this.drawMoney &#x3D; drawMoney;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void drawingMoney(Account account, int drawMoney) &#123;</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + &quot;取&quot; + drawMoney);</span><br><span class="line">        if (account.getMoney() &lt; drawMoney) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + &quot; 余额不足&quot;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            Thread.sleep(1000L);</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        account.setMoney(account.getMoney() - drawMoney);</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + &quot;取&quot; + drawMoney + &quot;,剩余&quot; + account.getMoney());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        drawingMoney(account, drawMoney);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; output</span><br><span class="line">小王取100</span><br><span class="line">小明取50</span><br><span class="line">小明取50,剩余-50</span><br><span class="line">小王取100,剩余-50</span><br></pre></td></tr></table></figure>
<ul>
<li>不安全集合</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class UnsafeList &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class="line">        List&lt;String&gt; unsafeList &#x3D; new LinkedList&lt;&gt;();</span><br><span class="line">        for (int i &#x3D; 0; i &lt; 10000; i++) &#123;</span><br><span class="line">            Thread thread &#x3D; new Thread(() -&gt; unsafeList.add(Thread.currentThread().getName()), &quot;thread name: &quot; + i);</span><br><span class="line">            thread.start();</span><br><span class="line">        &#125;</span><br><span class="line">        Thread.sleep(10000L);</span><br><span class="line">        System.out.println(unsafeList.size());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="同步方法和同步代码块"><a href="#同步方法和同步代码块" class="headerlink" title="同步方法和同步代码块"></a>同步方法和同步代码块</h2><ul>
<li>同步方法：在方法中加入<code>synchronized</code>关键字</li>
<li>同步代码块：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">synchronized (obj) &#123;</span><br><span class="line">	&#x2F;&#x2F; 同步的内容</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="线程不安全问题解决案例"><a href="#线程不安全问题解决案例" class="headerlink" title="线程不安全问题解决案例"></a>线程不安全问题解决案例</h2><ul>
<li>购票问题</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public class BuyTicket implements Runnable &#123;</span><br><span class="line"></span><br><span class="line">    private int ticketCount &#x3D; 10;</span><br><span class="line"></span><br><span class="line">    synchronized void buy () throws InterruptedException &#123;</span><br><span class="line">        while (ticketCount &gt; 0) &#123;</span><br><span class="line">            Thread.sleep(100L);</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + &quot; -&gt; 买到票&quot; + ticketCount +  &quot;，剩余:&quot; + --ticketCount);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            buy();</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        BuyTicket buyTicket &#x3D; new BuyTicket();</span><br><span class="line">        Thread thread1 &#x3D; new Thread(buyTicket, &quot;小明&quot;);</span><br><span class="line">        Thread thread2 &#x3D; new Thread(buyTicket, &quot;小王&quot;);</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>银行账户余额问题</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">public class UnsafeBank &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Account account &#x3D; new Account(100, &quot;bank&quot;);</span><br><span class="line">        DrawingMoney one &#x3D; new DrawingMoney(account, 50, &quot;小明&quot;);</span><br><span class="line">        DrawingMoney two &#x3D; new DrawingMoney(account, 100, &quot;小王&quot;);</span><br><span class="line">        one.start();</span><br><span class="line">        two.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Account extends Thread &#123;</span><br><span class="line"></span><br><span class="line">    private int money;</span><br><span class="line">    private String userNumber;</span><br><span class="line"></span><br><span class="line">    public Account(int money, String userNumber) &#123;</span><br><span class="line">        this.money &#x3D; money;</span><br><span class="line">        this.userNumber &#x3D; userNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getMoney() &#123;</span><br><span class="line">        return money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setMoney(int money) &#123;</span><br><span class="line">        this.money &#x3D; money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getUserNumber() &#123;</span><br><span class="line">        return userNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUserNumber(String userNumber) &#123;</span><br><span class="line">        this.userNumber &#x3D; userNumber;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class DrawingMoney extends Thread &#123;</span><br><span class="line"></span><br><span class="line">    private Account account;</span><br><span class="line">    private int drawMoney;</span><br><span class="line"></span><br><span class="line">    public DrawingMoney(Account account, int drawMoney, String name) &#123;</span><br><span class="line">        super(name);</span><br><span class="line">        this.account &#x3D; account;</span><br><span class="line">        this.drawMoney &#x3D; drawMoney;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void drawingMoney(Account account, int drawMoney) &#123;</span><br><span class="line">        synchronized (account) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + &quot;取&quot; + drawMoney);</span><br><span class="line">            if (account.getMoney() &lt; drawMoney) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + &quot; 余额不足&quot;);</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            try &#123;</span><br><span class="line">                Thread.sleep(1000L);</span><br><span class="line">            &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            account.setMoney(account.getMoney() - drawMoney);</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + &quot;取&quot; + drawMoney + &quot;,剩余&quot; + account.getMoney());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        drawingMoney(account, drawMoney);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>不安全集合</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class UnsafeList &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class="line">        List&lt;String&gt; unsafeList &#x3D; new LinkedList&lt;&gt;();</span><br><span class="line">        for (int i &#x3D; 0; i &lt; 10000; i++) &#123;</span><br><span class="line">            Thread thread &#x3D; new Thread(() -&gt; &#123;</span><br><span class="line">                synchronized (unsafeList) &#123;</span><br><span class="line">                    unsafeList.add(Thread.currentThread().getName());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, &quot;thread name: &quot; + i);</span><br><span class="line">            thread.start();</span><br><span class="line">        &#125;</span><br><span class="line">        Thread.sleep(10000L);</span><br><span class="line">        System.out.println(unsafeList.size());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="死锁问题"><a href="#死锁问题" class="headerlink" title="死锁问题"></a>死锁问题</h2><p>多个线程各自占有一些共享资源，并且相互其他资源才能继续运行，两个或者多个线程都在等待对方释放资源，双方都停止执行的情况，称为死锁。</p>
<p>当一个同步块同时拥有<strong>两个以上的对象锁</strong>时，就有可能出现死锁问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">public class DeadLock &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        KeyOne keyOne &#x3D; new KeyOne();</span><br><span class="line">        KeyTwo keyTwo &#x3D; new KeyTwo();</span><br><span class="line"></span><br><span class="line">        Thread thread1 &#x3D; new Thread(() -&gt; &#123;</span><br><span class="line">            synchronized (keyOne) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + &quot; I have key one, I need key two&quot;);</span><br><span class="line">                try &#123;</span><br><span class="line">                    Thread.sleep(100L);</span><br><span class="line">                &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                synchronized (keyTwo) &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + &quot; finish&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, &quot;thread-1&quot;);</span><br><span class="line"></span><br><span class="line">        Thread thread2 &#x3D; new Thread(() -&gt; &#123;</span><br><span class="line">            synchronized (keyTwo) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + &quot; I have key two, I need key one&quot;);</span><br><span class="line">                try &#123;</span><br><span class="line">                    Thread.sleep(100L);</span><br><span class="line">                &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                synchronized (keyOne) &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + &quot; finish&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, &quot;thread-1&quot;);</span><br><span class="line"></span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class KeyOne &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class KeyTwo &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; output</span><br><span class="line">thread-1 I have key one, I need key two</span><br><span class="line">thread-1 I have key two, I need key one</span><br></pre></td></tr></table></figure>
<h2 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h2><p>从JDK1.5开始，可以显式定义同步锁。</p>
<p><code>ReentrantLock</code>为可重入锁，在<code>java.util.concurrent.locks</code>下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">public class LockDemo implements Runnable &#123;</span><br><span class="line"></span><br><span class="line">    private int ticketCount &#x3D; 10;</span><br><span class="line">    private Lock lock &#x3D; new ReentrantLock();</span><br><span class="line"></span><br><span class="line">    void buy() throws InterruptedException &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            lock.lock();</span><br><span class="line">            while (ticketCount &gt; 0) &#123;</span><br><span class="line">                Thread.sleep(100L);</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + &quot; -&gt; 买到票&quot; + ticketCount + &quot;，剩余:&quot; + --ticketCount);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            buy();</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        BuyTicket buyTicket &#x3D; new BuyTicket();</span><br><span class="line">        Thread thread1 &#x3D; new Thread(buyTicket, &quot;小明&quot;);</span><br><span class="line">        Thread thread2 &#x3D; new Thread(buyTicket, &quot;小王&quot;);</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="生产者消费者问题"><a href="#生产者消费者问题" class="headerlink" title="生产者消费者问题"></a>生产者消费者问题</h2><blockquote>
<p>问题描述：</p>
<ul>
<li>假设仓库中只能存放一件产品，生产者将生产出的商品放入仓库中，消费者将仓库中的产品取走消费掉。</li>
<li>如果仓库中没有产品，则生产者将产品放入仓库，否则停止生产并等待，直到仓库中的产品被消费者取走为止。</li>
<li>如果仓库中放有产品，则消费者可以将产品取走消费，否则停止消费并等待，直到仓库中再次放入产品为止。</li>
</ul>
</blockquote>
<p>Java提供的几个解决线程之间通信问题的方法，线程通信是通信在等待队列中的线程，需要用锁对象来调用线程间通信方法。调用这些方法必须在<code>synchronized</code>中否则会抛出<code>IllegalMonitorStateException</code>异常</p>
<ul>
<li>wait()</li>
<li>ait(long timeout)</li>
<li>notify()</li>
<li>notifyAll()</li>
</ul>
<p>利用缓冲区解决问题，也可以利用标记来解决问题。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProducerAndConsumer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ProductContainer productContainer = <span class="keyword">new</span> ProductContainer();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            Producer producer = <span class="keyword">new</span> Producer(productContainer, <span class="string">&quot;producer -&gt; &quot;</span> + i);</span><br><span class="line">            Consumer consumer = <span class="keyword">new</span> Consumer(productContainer, <span class="string">&quot;consumer -&gt; &quot;</span> + i);</span><br><span class="line">            producer.start();</span><br><span class="line">            consumer.start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ProductContainer container;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Producer</span><span class="params">(ProductContainer container, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">        <span class="keyword">this</span>.container = container;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">product</span><span class="params">(Production production)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        container.push(production);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                product(<span class="keyword">new</span> Production(Thread.currentThread().getName() + <span class="string">&quot; &amp; &quot;</span> + i));</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ProductContainer container;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Consumer</span><span class="params">(ProductContainer container, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">        <span class="keyword">this</span>.container = container;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">consume</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        container.pop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">                consume();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductContainer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 安全容器用来存贮商品</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> LinkedList&lt;Production&gt; productions = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(Production production)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="comment">// 多生产者多消费者是需要使用while循环判断</span></span><br><span class="line">            <span class="keyword">while</span> (productions.size() &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>.wait();</span><br><span class="line">            &#125;</span><br><span class="line">            productions.push(production);</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; ++ &quot;</span> + production.getProductId());</span><br><span class="line">            <span class="keyword">this</span>.notifyAll();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (productions.size() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>.wait();</span><br><span class="line">            &#125;</span><br><span class="line">            Production production = productions.pop();</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; -- &quot;</span> + production.getProductId());</span><br><span class="line">            <span class="keyword">this</span>.notifyAll();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Production</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String productionId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Production</span><span class="params">(String productId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.productionId = productId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getProductId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> productionId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h2><p>经常创建和销毁线程会使用大量资源，对性能的影响很大。</p>
<p>可以提前创建好一些线程，在使用的时候直接获取，使用完后放回池子中循环利用。</p>
<p>好处：</p>
<ul>
<li>提高响应速度</li>
<li>降低资源消耗</li>
<li>便于线程管理</li>
</ul>
<p>核心参数：</p>
<ul>
<li>corePoolSize：核心线程数量</li>
<li>maximumPoolSize：最大线程数</li>
<li>keepAliveTime：等待线程最大存活时间</li>
</ul>
<blockquote>
<p>使用到的类<code>ExecutorService</code>和<code>Executors</code></p>
<p><code>ExecutorService</code>：真正的线程池接口，常见子类ThreadPoolExecutor。</p>
<p><code>Executors</code>：工具类，线程池的工厂类，用于创建并返回不同类型的线程池。</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wanglu92.github.io/2021/01/13/Markdown%E8%AF%AD%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/13/Markdown%E8%AF%AD%E6%B3%95/" itemprop="url">Markdown语法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-13T12:25:36+08:00">
                2021-01-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、什么是Markdown"><a href="#一、什么是Markdown" class="headerlink" title="一、什么是Markdown"></a>一、什么是Markdown</h2><p>Markdown 是一种轻量级标记语言，它允许人们使用易读易写的纯文本格式编写文档。</p>
<p>Markdown 语言在 2004 由约翰·格鲁伯<code>John Gruber</code>创建。</p>
<p>Markdown 编写的文档可以导出 HTML 、Word、图像、PDF、Epub 等多种格式的文档。</p>
<p>Markdown 编写的文档后缀为 <strong>.md</strong>, <strong>.markdown</strong>。</p>
<h2 id="二、Markdown基本语法"><a href="#二、Markdown基本语法" class="headerlink" title="二、Markdown基本语法"></a>二、Markdown基本语法</h2><h3 id="1-Markdown标题"><a href="#1-Markdown标题" class="headerlink" title="1. Markdown标题"></a>1. Markdown标题</h3><p>使用<code>#</code>号可以标识1-6级标题，注意<code>#</code>和标题之间有空格分隔。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 标题一</span></span><br><span class="line"><span class="section">## 标题二</span></span><br><span class="line"><span class="section">### 标题三</span></span><br><span class="line"><span class="section">#### 标题四</span></span><br><span class="line"><span class="section">##### 标题五</span></span><br><span class="line"><span class="section">###### 标题六</span></span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<h1 id="标题一"><a href="#标题一" class="headerlink" title="标题一"></a>标题一</h1><h2 id="标题二"><a href="#标题二" class="headerlink" title="标题二"></a>标题二</h2><h3 id="标题三"><a href="#标题三" class="headerlink" title="标题三"></a>标题三</h3><h4 id="标题四"><a href="#标题四" class="headerlink" title="标题四"></a>标题四</h4><h5 id="标题五"><a href="#标题五" class="headerlink" title="标题五"></a>标题五</h5><h6 id="标题六"><a href="#标题六" class="headerlink" title="标题六"></a>标题六</h6><h3 id="2-Markdown段落"><a href="#2-Markdown段落" class="headerlink" title="2. Markdown段落"></a>2. Markdown段落</h3><p>Markdown段落没有特殊的格式，直接编写文字，段落的换行是使用两个以上空格加上回车。</p>
<h3 id="3-Markdown斜体"><a href="#3-Markdown斜体" class="headerlink" title="3. Markdown斜体"></a>3. Markdown斜体</h3><p>斜体使用<code>*</code>包裹文本。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="emphasis">*斜体*</span></span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p><em>斜体</em></p>
<h3 id="4-Markdown粗体"><a href="#4-Markdown粗体" class="headerlink" title="4. Markdown粗体"></a>4. Markdown粗体</h3><p>粗体使用<code>**</code>包裹文本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**粗体**</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p><strong>粗体</strong></p>
<h3 id="5-Markdown斜体加粗"><a href="#5-Markdown斜体加粗" class="headerlink" title="5. Markdown斜体加粗"></a>5. Markdown斜体加粗</h3><p>斜体加粗使用<code>***</code>包裹文本。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="strong">**<span class="emphasis">*粗斜体文本<span class="strong">**<span class="emphasis">*</span></span></span></span></span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p><strong><em>粗斜体文本</em></strong></p>
<h3 id="6-Markdown分割线"><a href="#6-Markdown分割线" class="headerlink" title="6. Markdown分割线"></a>6. Markdown分割线</h3><p>可以在一行中用三个以上的<code>***</code>星号、<code>---</code>减号、<code>___</code>底线来建立一个分隔线，<strong>行内不能有其它内容</strong>，可以在星号或是减号中间插入空格，下面每种写法都可以建立分隔线：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">***</span><br><span class="line">* * *</span><br><span class="line">*****</span><br><span class="line">- - -</span><br><span class="line">----------</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<hr>
<hr>
<hr>
<hr>
<hr>
<h3 id="7-Markdown删除线"><a href="#7-Markdown删除线" class="headerlink" title="7. Markdown删除线"></a>7. Markdown删除线</h3><p>如果段落上的文字要添加删除线，只需要用波浪线 <code>~~</code>包裹文本内容即可。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~~删除线~~</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p><del>删除线</del></p>
<h3 id="8-Markdown下划线"><a href="#8-Markdown下划线" class="headerlink" title="8. Markdown下划线"></a>8. Markdown下划线</h3><p>下划线可以通过 HTML 的<code>&lt;u&gt;</code>标签来实现。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">u</span>&gt;</span></span>下划线<span class="xml"><span class="tag">&lt;/<span class="name">u</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p><u>下划线</u></p>
<h3 id="9-Markdown脚注"><a href="#9-Markdown脚注" class="headerlink" title="9. Markdown脚注"></a>9. Markdown脚注</h3><p>脚注是对文本的补充说明，Markdown脚注的格式<code>[^footnote]</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">引用脚注[^footnote]</span><br><span class="line">[^footnote]: 脚注！</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p>引用脚注<a href="%E8%84%9A%E6%B3%A8%EF%BC%81">^footnote</a></p>
<h3 id="10-Markdown无序列表"><a href="#10-Markdown无序列表" class="headerlink" title="10. Markdown无序列表"></a>10. Markdown无序列表</h3><p>无序列表使用星号<code>*</code>、加号<code>+</code>或是减号<code>-</code>作为列表标记，这些标记后面要添加一个空格，然后再填写内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 第一项</span><br><span class="line">* 第二项</span><br><span class="line">* 第三项</span><br><span class="line">---</span><br><span class="line">+ 第一项</span><br><span class="line">+ 第二项</span><br><span class="line">+ 第三项</span><br><span class="line">---</span><br><span class="line">- 第一项</span><br><span class="line">- 第二项</span><br><span class="line">- 第三项</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<ul>
<li>第一项</li>
<li>第二项</li>
<li>第三项</li>
</ul>
<hr>
<ul>
<li>第一项</li>
<li>第二项</li>
<li>第三项</li>
</ul>
<hr>
<ul>
<li>第一项</li>
<li>第二项</li>
<li>第三项</li>
</ul>
<h3 id="11-Markdown有序列表"><a href="#11-Markdown有序列表" class="headerlink" title="11. Markdown有序列表"></a>11. Markdown有序列表</h3><p>有序列表使用数字并加上 <code>.</code>来表示。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 第一项</span><br><span class="line">2. 第二项</span><br><span class="line">3. 第三项</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<ol>
<li>第一项</li>
<li>第二项</li>
<li>第三项</li>
</ol>
<h3 id="12-Markdown列表嵌套"><a href="#12-Markdown列表嵌套" class="headerlink" title="12. Markdown列表嵌套"></a>12. Markdown列表嵌套</h3><p>列表嵌套只需在子列表中的选项前面添加四个空格。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 第一项：</span><br><span class="line">    - 第一项嵌套的第一个元素</span><br><span class="line">    - 第一项嵌套的第二个元素</span><br><span class="line">2. 第二项：</span><br><span class="line">    - 第二项嵌套的第一个元素</span><br><span class="line">    - 第二项嵌套的第二个元素</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<ol>
<li>第一项：<ul>
<li>第一项嵌套的第一个元素</li>
<li>第一项嵌套的第二个元素</li>
</ul>
</li>
<li>第二项：<ul>
<li>第二项嵌套的第一个元素</li>
<li>第二项嵌套的第二个元素</li>
</ul>
</li>
</ol>
<h3 id="13-Markdown区块"><a href="#13-Markdown区块" class="headerlink" title="13. Markdown区块"></a>13. Markdown区块</h3><p>区块引用是在段落开头使用<code>&gt;</code>符号 ，然后后面紧跟一个<strong>空格</strong>符号：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; 区块</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<blockquote>
<p>区块</p>
</blockquote>
<h3 id="14-Markdown区块嵌套"><a href="#14-Markdown区块嵌套" class="headerlink" title="14. Markdown区块嵌套"></a>14. Markdown区块嵌套</h3><p>另外区块是可以嵌套的，一个 <code>&gt;</code>符号是最外层，两个 <code>&gt;</code> 符号是第一层嵌套。</p>
<p>区块可以和列表一起使用。列表中也可以使用区块。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">区块嵌套：</span><br><span class="line">&gt; 最外层</span><br><span class="line">&gt; &gt; 第一层嵌套</span><br><span class="line">&gt; &gt; &gt; 第二层嵌套</span><br><span class="line"></span><br><span class="line">区块总使用列表：</span><br><span class="line">&gt; 1. 第一项</span><br><span class="line">&gt; 2. 第二项</span><br><span class="line">&gt; + 第一项</span><br><span class="line">&gt; + 第二项</span><br><span class="line"></span><br><span class="line">列表中使用区块：</span><br><span class="line">* 第一项</span><br><span class="line">    &gt; 区块</span><br><span class="line">* 第二项</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p>区块嵌套：</p>
<blockquote>
<p>最外层</p>
<blockquote>
<p>第一层嵌套</p>
<blockquote>
<p>第二层嵌套</p>
</blockquote>
</blockquote>
</blockquote>
<p>区块总使用列表：</p>
<blockquote>
<ol>
<li>第一项</li>
<li>第二项</li>
</ol>
<ul>
<li>第一项</li>
<li>第二项</li>
</ul>
</blockquote>
<p>列表中使用区块：</p>
<ul>
<li><p>第一项</p>
<blockquote>
<p>区块</p>
</blockquote>
</li>
<li><p>第二项</p>
</li>
</ul>
<h3 id="15-Markdown代码"><a href="#15-Markdown代码" class="headerlink" title="15.Markdown代码"></a>15.Markdown代码</h3><p>如果是段落上的一个函数或片段的代码可以用反引号把它包起来**`**。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#96;printf()&#96;</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p><code>printf()</code></p>
<h3 id="16-Markdown代码区块"><a href="#16-Markdown代码区块" class="headerlink" title="16. Markdown代码区块"></a>16. Markdown代码区块</h3><p>使用**```<strong>包裹代码块或使用 **4 个空格</strong>或者一个制表符。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">​```</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Hello world&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">​```</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Hello world&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="17-Markdown链接"><a href="#17-Markdown链接" class="headerlink" title="17.Markdown链接"></a>17.Markdown链接</h3><p>链接使用方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[链接名称](链接地址)</span><br><span class="line">或者直接使用连接</span><br><span class="line">&lt;链接地址&gt;</span><br></pre></td></tr></table></figure>
<p>效果如下</p>
<p><a href="www.baidu.com">百度</a><br>&lt;<a target="_blank" rel="noopener" href="http://www.baidu.com&gt;/">www.baidu.com&gt;</a></p>
<h3 id="18-Markdown高级链接"><a href="#18-Markdown高级链接" class="headerlink" title="18.Markdown高级链接"></a>18.Markdown高级链接</h3><p>我们可以通过变量来设置一个链接，变量赋值在文档末尾进行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">这个链接用 1 作为网址变量 [Google][1]</span><br><span class="line">[1]: http:&#x2F;&#x2F;www.google.com&#x2F;</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p>这个链接用 1 作为网址变量 <a target="_blank" rel="noopener" href="http://www.google.com/">Google</a></p>
<h3 id="19-Markdown图片"><a href="#19-Markdown图片" class="headerlink" title="19.Markdown图片"></a>19.Markdown图片</h3><p>Markdown 图片语法格式如下：</p>
<p>开头一个感叹号，接着一个方括号，里面放上图片的替代文字，接着一个普通括号，里面放上图片的网址，最后还可以用引号包住并加上选择性的 ‘title’ 属性的文字。</p>
<p>Markdown 还没有办法指定图片的高度与宽度，如果你需要的话，你可以使用普通的 <img> 标签。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">![alt 属性文本](图片地址)</span><br><span class="line">![alt 属性文本](图片地址 &quot;可选标题&quot;)</span><br><span class="line"></span><br><span class="line">![到百度首页](https:&#x2F;&#x2F;www.baidu.com&#x2F;img&#x2F;flexible&#x2F;logo&#x2F;pc&#x2F;result@2.png)</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p><img src="https://www.baidu.com/img/flexible/logo/pc/result@2.png" alt="百度"></p>
<h3 id="20-Markdown表格"><a href="#20-Markdown表格" class="headerlink" title="20. Markdown表格"></a>20. Markdown表格</h3><p>Markdown 制作表格使用 <strong>|</strong> 来分隔不同的单元格，使用 <strong>-</strong> 来分隔表头和其他行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|  表头   | 表头  |</span><br><span class="line">|  ----  | ----  |</span><br><span class="line">| 单元格  | 单元格 |</span><br><span class="line">| 单元格  | 单元格 |</span><br></pre></td></tr></table></figure>
<p>对齐方式</p>
<p><strong>我们可以设置表格的对齐方式：</strong></p>
<ul>
<li><code>-:</code> 设置内容和标题栏居右对齐。</li>
<li><code>:-</code> 设置内容和标题栏居左对齐。</li>
<li><code>:-:</code> 设置内容和标题栏居中对齐。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">| 左对齐 | 右对齐 | 居中对齐 |</span><br><span class="line">| :-----| ----: | :----: |</span><br><span class="line">| 单元格 | 单元格 | 单元格 |</span><br><span class="line">| 单元格 | 单元格 | 单元格 |</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<table>
<thead>
<tr>
<th align="left">左对齐</th>
<th align="right">右对齐</th>
<th align="center">居中对齐</th>
</tr>
</thead>
<tbody><tr>
<td align="left">单元格</td>
<td align="right">单元格</td>
<td align="center">单元格</td>
</tr>
<tr>
<td align="left">单元格</td>
<td align="right">单元格</td>
<td align="center">单元格</td>
</tr>
</tbody></table>
<h3 id="21-Markdown支持HTML标签"><a href="#21-Markdown支持HTML标签" class="headerlink" title="21.Markdown支持HTML标签"></a>21.Markdown支持HTML标签</h3><p>不在 Markdown 涵盖范围之内的标签，都可以直接在文档里面用 HTML 撰写。</p>
<p>目前支持的 HTML 元素有：<code>&lt;kbd&gt; &lt;b&gt; &lt;i&gt; &lt;em&gt; &lt;sup&gt; &lt;sub&gt; &lt;br&gt;</code>等 ，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用 &lt;kbd&gt;Ctrl&lt;&#x2F;kbd&gt;+&lt;kbd&gt;Alt&lt;&#x2F;kbd&gt;+&lt;kbd&gt;Del&lt;&#x2F;kbd&gt; 重启电脑</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p>使用 <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Del</kbd> 重启电脑</p>
<h3 id="22-Markdown转义"><a href="#22-Markdown转义" class="headerlink" title="22. Markdown转义"></a>22. Markdown转义</h3><p>Markdown 使用了很多特殊符号来表示特定的意义，如果需要显示特定的符号则需要使用转义字符，Markdown 使用反斜杠转义特殊字符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">\*\* 正常显示星号 \*\*</span><br><span class="line"></span><br><span class="line">支持一下字符转义：</span><br><span class="line">\   反斜线</span><br><span class="line">&#96;   反引号</span><br><span class="line">*   星号</span><br><span class="line">_   下划线</span><br><span class="line">&#123;&#125;  花括号</span><br><span class="line">[]  方括号</span><br><span class="line">()  小括号</span><br><span class="line">#   井字号</span><br><span class="line">+   加号</span><br><span class="line">-   减号</span><br><span class="line">.   英文句点</span><br><span class="line">!   感叹号</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p>** 正常显示星号 **</p>
<h3 id="23-Markdown数学公式"><a href="#23-Markdown数学公式" class="headerlink" title="23.Markdown数学公式"></a>23.Markdown数学公式</h3><p>当你需要在编辑器中插入数学公式时，可以使用两个美元符 <code>$$</code> 包裹 TeX 或 LaTeX 格式的数学公式来实现，Markdown会加载 Mathjax对数学公式进行渲染。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\mathbf&#123;V&#125;_1 \times \mathbf&#123;V&#125;_2 &#x3D;  \begin&#123;vmatrix&#125; </span><br><span class="line">\mathbf&#123;i&#125; &amp; \mathbf&#123;j&#125; &amp; \mathbf&#123;k&#125; \\</span><br><span class="line">\frac&#123;\partial X&#125;&#123;\partial u&#125; &amp;  \frac&#123;\partial Y&#125;&#123;\partial u&#125; &amp; 0 \\</span><br><span class="line">\frac&#123;\partial X&#125;&#123;\partial v&#125; &amp;  \frac&#123;\partial Y&#125;&#123;\partial v&#125; &amp; 0 \\</span><br><span class="line">\end&#123;vmatrix&#125;</span><br><span class="line">$&#123;$tep1&#125;&#123;\style&#123;visibility:hidden&#125;&#123;(x+1)(x+1)&#125;&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure>
<p>效果如下：<br>$$<br>\mathbf{V}_1 \times \mathbf{V}_2 =  \begin{vmatrix}<br>\mathbf{i} &amp; \mathbf{j} &amp; \mathbf{k} \<br>\frac{\partial X}{\partial u} &amp;  \frac{\partial Y}{\partial u} &amp; 0 \<br>\frac{\partial X}{\partial v} &amp;  \frac{\partial Y}{\partial v} &amp; 0 \<br>\end{vmatrix}<br>${$tep1}{\style{visibility:hidden}{(x+1)(x+1)}}<br>$$</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://www.runoob.com/markdown/md-tutorial.html">菜鸟教程</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wanglu92.github.io/2021/01/07/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/07/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-07T20:19:14+08:00">
                2021-01-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20archive">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
